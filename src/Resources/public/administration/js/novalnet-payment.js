!function(t){var e={};function n(a){if(e[a])return e[a].exports;var o=e[a]={i:a,l:!1,exports:{}};return t[a].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(a,o,function(e){return t[e]}.bind(null,o));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p=(window.__sw__.assetPath + '/bundles/novalnetpayment/'),n(n.s="ZS5P")}({"3Y7e":function(t,e){Shopware.Service("privileges").addPrivilegeMappingEntry({category:"permissions",parent:"orders",key:"novalnet_extension",roles:{viewer:{privileges:["novalnet_transaction_details:read"],dependencies:[]},editor:{privileges:["novalnet_transaction_details:update","order_transaction:read","order_transaction:update"],dependencies:["novalnet_extension.viewer","order.editor"]},creator:{privileges:["novalnet_transaction_details:create"],dependencies:["novalnet_extension.viewer","novalnet_extension.editor"]},deleter:{privileges:["novalnet_transaction_details:delete"],dependencies:["novalnet_extension.viewer"]}}}),Shopware.Service("privileges").addPrivilegeMappingEntry({category:"permissions",parent:"novalnet_payment",key:"novalnet_payment",roles:{viewer:{privileges:["system_config:read","sales_channel:read"],dependencies:[]},editor:{privileges:["system_config:update","system_config:create","system_config:delete","sales_channel:update"],dependencies:["novalnet_payment.viewer"]}}})},"63fS":function(t,e,n){var a=n("ixpb");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,n("ydqr").default)("4fb49db6",a,!0,{})},"8zbr":function(t,e,n){},"9Izg":function(t,e,n){},QLrr:function(t,e,n){var a=n("odc0");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,n("ydqr").default)("e8791928",a,!0,{})},ZS5P:function(t,e,n){"use strict";n.r(e);n("63fS");var a=Shopware,o=a.Component,i=a.Mixin,l=a.Defaults,r=(a.Context,Shopware.Data.Criteria);o.register("novalnet-payment-settings",{template:'{% block novalnet_payment_settings %}\n    <sw-page class="novalnet-payment">\n        {% block novalnet_payment_settings_header %}\n            <template #smart-bar-header>\n                <h2>\n                    {{ $tc(\'sw-settings.index.title\') }}\n                    <sw-icon v-if="shopVersion" name="regular-chevron-right-xs" small></sw-icon>\n                    <sw-icon v-else name="small-arrow-medium-right" small></sw-icon>\n                    {{ $tc(\'novalnet-payment.settingForm.title\') }}\n                </h2>\n            </template>\n        {% endblock %}\n        \n        {% block novalnet_payment_settings_actions %}\n            <template #smart-bar-actions>\n\t\t\t\t{% block novalnet_payment_actions_save %}\n                    <sw-button-process v-model="isSaveSuccessful"\n                                       class="sw-settings-login-registration__save-action"\n                                       variant="primary"\n                                       :isLoading="isLoading"\n                                       :disabled="isLoading || !acl.can(\'novalnet_payment.editor\')"\n                                       @click="onSave">\n                        {{ $tc(\'novalnet-payment.settingForm.buttons.save\') }}\n                    </sw-button-process>\n                {% endblock %}\n            \n            </template>\n        {% endblock %}\n       \n        {% block novalnet_payment_content %}\n\t\t\t\n\t\t\t<template #content>\n\t\t\t\t{% block novalnet_payment_content_card %}\n\t\t\t\t\t<sw-card-view>\n\t\t\t\t\t{% block novalnet_payment_content_sales_channel_config %}\n\t\t\t\t\t\t\t<sw-sales-channel-config v-model="config"\n\t\t\t\t\t\t\t\t\t\t\t\t\t ref="configComponent"\n\t\t\t\t\t\t\t\t\t\t\t\t\t domain="NovalnetPayment.settings">\n\t\t\t\t\t\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t\t{% block novalnet_payment_content_sales_channelconfig_card %}\n\t\t\t\t\t\t\t\t  <template #select="{ onInput, selectedSalesChannelId, salesChannel}">\n\t\t\t\t\t\t\t\t\t{% block novalnet_payment_content_sales_channelconfig_card_sales_channel %}\n\t\t\t\t\t\t\t\t\t\t<sw-container class="novalnet-sales-channel">\n\t\t\t\t\t\t\t\t\t\t\t<sw-single-select v-model="selectedSalesChannelId"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabelProperty="translated.name"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalueProperty="id"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t:disabled="!acl.can(\'novalnet_payment.editor\')"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t:options="salesChannel"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@change="onInput">\n\t\t\t\t\t\t\t\t\t\t\t</sw-single-select>\n\t\t\t\t\t\t\t\t\t\t</sw-container>\n\t\t\t\t\t\t\t\t\t{% endblock %}\n\t\t\t\t\t\t\t\t  </template>\n\t\t\t\t\t\t\t\t{% endblock %}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t{% block novalnet_payment_config_content_channel_config_cards %}\n\t\t\t\t\t\t\t\t\t<template #content="{ actualConfigData, allConfigs, selectedSalesChannelId }">\n                                        <div v-if="actualConfigData">\n\t\t\t\t\t\t\t\t\t\t\t<sw-tabs>\n\t\t\t\t\t\t\t\t\t\t\t{% block novalnet_payment_content_card_channel_config_credentials_card %}\n                                                <sw-tabs-item class="novalnet-payment-configuration-global-config"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t:route="{ name: \'novalnet.payment.detail.credentials\', params: { id: $route.params.id, actualConfigData: actualConfigData } }"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  :title="$tc(\'novalnet-payment.module.globalTitle\')">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{{ $tc(\'novalnet-payment.module.globalTitle\') }}\n\t\t\t\t\t\t\t\t\t\t\t\t</sw-tabs-item>\n                                            {% endblock %}\n                                            </sw-tabs>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t{% block novalnet_payment_configuration_content_view %}\n\t\t\t\t\t\t\t\t\t\t<router-view :isLoading="isLoading"\n\t\t\t\t\t\t\t\t\t\t\t\t\t :key="$route.params.id"\n\t\t\t\t\t\t\t\t\t\t\t\t\t :actualConfigData="actualConfigData"\n\t\t\t\t\t\t\t\t\t\t\t\t\t :allConfigs="allConfigs"\n\t\t\t\t\t\t\t\t\t\t\t\t\t :selectedSalesChannelId="selectedSalesChannelId">\n\t\t\t\t\t\t\t\t\t\t</router-view>\n\t\t\t\t\t\t\t\t\t\t{% endblock %}\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t{% endblock %}\n\t\t\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t</sw-sales-channel-config>\n\t\t\t\t\t\t{% endblock %}\n\t\t\t\t\t\n\t\t\t\t\t\t{% block novalnet_payment_content_card_loading %}\n                            <sw-loader v-if="isLoading"></sw-loader>\n                        {% endblock %}\n                        \t\n\t\t\t\t\t</sw-card-view>\n\t\t\t\t{% endblock %}\n\t\t\t</template>\n        {% endblock %}   \n            \n    </sw-page>\n{% endblock %}\n',mixins:[i.getByName("notification"),i.getByName("sw-inline-snippet")],inject:["repositoryFactory","NovalPaymentApiCredentialsService","acl"],data:function(){return{isLoading:!1,isValidating:!1,isSaveSuccessful:!1,isValidateSuccessful:!1,clientIdFilled:!1,clientSecretFilled:!1,shopVersion:!1,config:{},salesChannels:[]}},computed:{validateButtonDisabled:function(){return this.isLoading||this.isValidating},novalnetConfigRoute:function(){return{name:"novalnet.payment.detail.credentials"}},salesChannelRepository:function(){return this.repositoryFactory.create("sales_channel")}},created:function(){this.createdComponent()},watch:{config:{deep:!0,handler:function(){var t=this,e=this.$refs.configComponent.allConfigs.null;null===this.$refs.configComponent.selectedSalesChannelId?this.clientIdFilled=!!this.config["NovalnetPayment.settings.clientId"]:(this.clientIdFilled=!!this.config["NovalnetPayment.settings.clientId"]||!!e["NovalnetPayment.settings.clientId"],this.clientSecretFilled=!!this.config["NovalnetPayment.settings.clientSecret"]),this.NovalPaymentApiCredentialsService.getShopVersion().then((function(e){""!=e&&null!=e&&e.version>="6.5.0.0"&&(t.shopVersion=!0)})).catch((function(e){t.createNotificationError({message:"".concat(e.title,": ").concat(e.message)})}))}}},methods:{createdComponent:function(){var t=this;this.isLoading=!0;var e=new r;e.addFilter(r.equalsAny("typeId",[l.storefrontSalesChannelTypeId,l.apiSalesChannelTypeId])),this.salesChannelRepository.search(e,Shopware.Context.api).then((function(e){e.add({id:null,translated:{name:t.$tc("sw-sales-channel-switch.labelDefaultOption")}}),t.salesChannels=e})).finally((function(){t.isLoading=!1}))},onSave:function(){this.isSaveSuccessful=!1,this.isLoading=!0;var t=this.getConfigValue("clientId"),e=this.getConfigValue("accessKey");if(""!==this.getConfigValue("clientId")&&void 0!==this.getConfigValue("clientId"))this.getConfigValue("clientId").replace(/\s/g,"");if(""!==this.getConfigValue("accessKey")&&void 0!==this.getConfigValue("accessKey"))this.getConfigValue("accessKey").replace(/\s/g,"");return null==t||""==t?(this.isLoading=!1,void this.createNotificationError({title:this.$tc("novalnet-payment.settingForm.titleError"),message:this.$tc("novalnet-payment.settingForm.emptyMessage")})):null==e||""==e?(this.isLoading=!1,void this.createNotificationError({title:this.$tc("novalnet-payment.settingForm.titleError"),message:this.$tc("novalnet-payment.settingForm.emptyAccessKeyMessage")})):void this.checkBackendConfiguration()},getConfigValue:function(t){var e=this.$refs.configComponent.allConfigs.null;return null===this.$refs.configComponent.selectedSalesChannelId?this.config["NovalnetPayment.settings.".concat(t)]:this.config["NovalnetPayment.settings.".concat(t)]||e["NovalnetPayment.settings.".concat(t)]},checkBackendConfiguration:function(){var t=this,e=this.getConfigValue("clientId").replace(/\s/g,""),n=this.getConfigValue("accessKey").replace(/\s/g,"");this.NovalPaymentApiCredentialsService.validateApiCredentials(e,n).then((function(e){if(t.isLoading=!1,null!=e.serverResponse&&""!=e.serverResponse)return 100!=e.serverResponse.result.status_code?void t.createNotificationError({title:t.$tc("novalnet-payment.settingForm.titleError"),message:e.serverResponse.result.status_text}):(e.tariffResponse.forEach((function(e){null!=t.config["NovalnetPayment.settings.tariff"]&&""!=t.config["NovalnetPayment.settings.tariff"]||(t.config["NovalnetPayment.settings.tariff"]=e.id)})),t.config["NovalnetPayment.settings.clientKey"]=e.serverResponse.merchant.client_key,t.$refs.configComponent.save().then((function(e){t.isSaveSuccessful=!0,e&&(t.config=e)})).catch((function(){t.isLoading=!1})),void t.createNotificationSuccess({title:t.$tc("novalnet-payment.settingForm.titleSuccess"),message:t.$tc("novalnet-payment.settingForm.successMessage")}));t.createNotificationError({title:t.$tc("novalnet-payment.settingForm.titleError"),message:t.$tc("novalnet-payment.settingForm.apiFailureMessage")})})).catch((function(e){t.createNotificationError({title:t.$tc("novalnet-payment.settingForm.titleError"),message:t.$tc("novalnet-payment.settingForm.errorMessage")}),t.isLoading=!1,t.isTestSuccessful=!1}))}},metaInfo:function(){return{title:this.$createTitle()}}});n("QLrr");function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){m(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function m(t,e,n){return(e=function(t){var e=function(t,e){if("object"!==s(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var a=n.call(t,e||"default");if("object"!==s(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===s(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var u=Shopware,p=u.Component,f=u.Mixin,h=(Shopware.Data.Criteria,Shopware.Utils);h.object,h.types;p.register("novalnet-payment-credentials",{template:'{% block novalnet_payment_content_card_channel_config_credentials %}\n<sw-card-view style="position: relative;">\n\t<div v-if="actualConfigData" class="novalnet-payment-settings-fields">\n\t\t<sw-card class="sw-card--grid"\n\t\t\t\t :title="$tc(\'novalnet-payment.settingForm.credentials.cardTitle\')">\n\n\t\t\t{% block novalnet_payment_content_card_channel_config_credentials_card_container %}\n\t\t\t\t<sw-container>\n\n\t\t\t\t\t{% block novalnet_payment_content_card_channel_config_credentials_card_container_settings %}\n\t\t\t\t\t\t<div v-if="actualConfigData" class="novalnet_payment-settings-credentials">\n\t\t\t\t\t\t<sw-alert v-if="projectMode" variant="info" appearance="default" :showIcon="true" :closable="false">\n\t\t\t\t\t\t\t{{ $tc(\'novalnet-payment.module.projectInfo\') }}\n\t\t\t\t\t\t</sw-alert>\n\n\t\t\t\t\t\t<div v-html="generalInformation" class="novalnet_payment-settings-project">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div v-html="PaymentConfiguration" class="novalnet_payment-settings-project">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<br>\n\n\t\t\t\t\t\t\t{% block novalnet_payment_content_card_channel_config_credentials_card_container_settings_client_id %}\n\t\t\t\t\t\t\t\t<sw-inherit-wrapper v-model="actualConfigData[\'NovalnetPayment.settings.clientId\']"\n\t\t\t\t\t\t\t\t\t\t\t\t\t:inheritedValue="selectedSalesChannelId == null ? null : allConfigs[\'null\'][\'NovalnetPayment.settings.clientId\']"\n\t\t\t\t\t\t\t\t\t\t\t\t\t:customInheritationCheckFunction="checkTextFieldInheritance">\n\t\t\t\t\t\t\t\t\t<template #content="props">\n\t\t\t\t\t\t\t\t\t\t<sw-text-field name="NovalnetPayment.settings.clientId"\n\t\t\t\t\t\t\t\t\t\t\t\t\t   :value="apiActivationKey == null ? props.currentValue : apiActivationKey"\n\t\t\t\t\t\t\t\t\t\t\t\t\t   :label="$tc(\'novalnet-payment.settingForm.credentials.activationKey.label\') | raw "\n\t\t\t\t\t\t\t\t\t\t\t\t\t   :helpText="$tc(\'novalnet-payment.settingForm.credentials.activationKey.tooltipText\')"\n\t\t\t\t\t\t\t\t\t\t\t\t\t   :disabled="!acl.can(\'novalnet_payment.editor\')"\n\t\t\t\t\t\t\t\t\t\t\t\t\t   @change="onCheckApi"\n\t\t\t\t\t\t\t\t\t\t\t\t\t   >\n\t\t\t\t\t\t\t\t\t\t</sw-text-field>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</sw-inherit-wrapper>\n\t\t\t\t\t\t\t\t<sw-inherit-wrapper v-model="actualConfigData[\'NovalnetPayment.settings.accessKey\']"\n\t\t\t\t\t\t\t\t\t\t\t\t\t:inheritedValue="selectedSalesChannelId == null ? null : allConfigs[\'null\'][\'NovalnetPayment.settings.accessKey\']"\n\t\t\t\t\t\t\t\t\t\t\t\t\t:customInheritationCheckFunction="checkTextFieldInheritance">\n\t\t\t\t\t\t\t\t\t<template #content="props">\n\t\t\t\t\t\t\t\t\t\t<sw-text-field name="NovalnetPayment.settings.accessKey"\n\t\t\t\t\t\t\t\t\t\t\t\t\t   :value="paymentAccessKey == null ? props.currentValue : paymentAccessKey"\n\t\t\t\t\t\t\t\t\t\t\t\t\t   autocomplete="off"\n\t\t\t\t\t\t\t\t\t\t\t\t\t   :label="$tc(\'novalnet-payment.settingForm.credentials.accessKey.label\')"\n\t\t\t\t\t\t\t\t\t\t\t\t\t   :helpText="$tc(\'novalnet-payment.settingForm.credentials.accessKey.tooltipText\')"\n\t\t\t\t\t\t\t\t\t\t\t\t\t   :disabled="!acl.can(\'novalnet_payment.editor\')"\n\t\t\t\t\t\t\t\t\t\t\t\t\t   @change="onCheckApi"\n\t\t\t\t\t\t\t\t\t\t\t\t\t   >\n\t\t\t\t\t\t\t\t\t\t</sw-text-field>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</sw-inherit-wrapper>\n\t\t\t\t\t\t\t{% endblock %}\n\t\t\t\t\t\t\t{% block novalnet_payment_content_card_channel_config_credentials_card_container_settings_break %}\n\t\t\t\t\t\t\t\t<br>\n\t\t\t\t\t\t\t{% endblock %}\n\n\t\t\t\t\t\t\t{% block novalnet_payment_content_card_channel_config_credentials_card_container_settings_client_secret %}\n\t\t\t\t\t\t\t\t<sw-inherit-wrapper v-model="actualConfigData[\'NovalnetPayment.settings.clientKey\']"\n\t\t\t\t\t\t\t\t\t\t\t\t\t:inheritedValue="selectedSalesChannelId == null ? null : allConfigs[\'null\'][\'NovalnetPayment.settings.clientKey\']"\n\t\t\t\t\t\t\t\t\t\t\t\t\t:customInheritationCheckFunction="checkTextFieldInheritance">\n\t\t\t\t\t\t\t\t\t<template #content="props">\n\t\t\t\t\t\t\t\t\t\t<sw-text-field name="NovalnetPayment.settings.clientKey"\n\t\t\t\t\t\t\t\t\t\t\t\t\t   :mapInheritance="props"\n\t\t\t\t\t\t\t\t\t\t\t\t\t   v-show="shouldDisable"\n\t\t\t\t\t\t\t\t\t\t\t\t\t   :disabled="!acl.can(\'novalnet_payment.editor\')"\n\t\t\t\t\t\t\t\t\t\t\t\t\t   :value="props.currentValue">\n\t\t\t\t\t\t\t\t\t\t</sw-text-field>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</sw-inherit-wrapper>\n\t\t\t\t\t\t\t\t<sw-inherit-wrapper v-model="actualConfigData[\'NovalnetPayment.settings.tariff\']"\n\t\t\t\t\t\t\t\t\t\t\t\t\t:inheritedValue="selectedSalesChannelId == null ? null : allConfigs[\'null\'][\'NovalnetPayment.settings.tariff\']">\n\t\t\t\t\t\t\t\t\t<template #content="props">\n\t\t\t\t\t\t\t\t\t\t<sw-single-select name="NovalnetPayment.settings.tariff"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t  :v-model="tariffId"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t  :options="tariffOptions"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t  :label="$tc(\'novalnet-payment.settingForm.credentials.tariff.label\')"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t  :helpText="$tc(\'novalnet-payment.settingForm.credentials.tariff.tooltipText\')"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t  :value="props.currentValue"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t  :disabled="!acl.can(\'novalnet_payment.editor\')"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t  @change="props.updateCurrentValue">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t  \n\t\t\t\t\t\t\t\t\t\t</sw-single-select>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</sw-inherit-wrapper>\n\t\t\t\t\t\t\t\t<sw-inherit-wrapper v-model="actualConfigData[\'NovalnetPayment.settings.emailMode\']"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t:inheritedValue="selectedSalesChannelId == null ? null : allConfigs[\'null\'][\'NovalnetPayment.settings.emailMode\']"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t:customInheritationCheckFunction="checkBoolFieldInheritance">\n\t\t\t\t\t\t\t\t\t\t<template #content="props">\n\t\t\t\t\t\t\t\t\t\t\t<sw-switch-field name="NovalnetPayment.settings.emailMode"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   :mapInheritance="props"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   :label="$tc(\'novalnet-payment.settingForm.credentials.orderEmailMode.label\')"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   :helpText="$tc(\'novalnet-payment.settingForm.credentials.orderEmailMode.tooltipText\')"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   :value="props.currentValue"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   :disabled="!acl.can(\'novalnet_payment.editor\')"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   @change="props.updateCurrentValue">\n\t\t\t\t\t\t\t\t\t\t\t</sw-switch-field>\n\t\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t</sw-inherit-wrapper>\n\t\t\t\t\t\t\t{% endblock %}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{% endblock %}\n\n\t\t\t\t\t{% block novalnet_payment_content_card_loading %}\n                        <sw-loader v-if="isLoading"></sw-loader>\n                    {% endblock %}\n\n\t\t\t\t</sw-container>\n\t\t\t{% endblock %}\n\t\t</sw-card>\n\t{% endblock %}\n\t{% block novalnet_payment_content_card_channel_config_merchant_credentials %}\n\t\t<sw-card class="sw-card--grid"\n\t\t\t\t :title="$tc(\'novalnet-payment.settingForm.merchantSettings.cardTitle\')">\n\t\t\t{% block novalnet_payment_content_card_channel_config_merchant_credentials_card_container %}\n\t\t\t\t<sw-container>\n\t\t\t\t\t{% block novalnet_payment_content_card_channel_config_merchant_credentials_card_container_settings %}\n\t\t\t\t\t\t<div v-if="actualConfigData" class="novalnet_payment-settings-merchant-credentials">\n\t\t\t\t\t\t\t{% block novalnet_payment_content_card_channel_config_merchant_credentials_card_container_settings_ip %}\n\n\t\t\t\t\t\t\t\t<sw-inherit-wrapper v-model="actualConfigData[\'NovalnetPayment.settings.callbackUrl\']"\n\t\t\t\t\t\t\t\t\t\t\t\t\t:inheritedValue="selectedSalesChannelId == null ? null : allConfigs[\'null\'][\'NovalnetPayment.settings.callbackUrl\']"\n\t\t\t\t\t\t\t\t\t\t\t\t\t:customInheritationCheckFunction="checkTextFieldInheritance">\n\t\t\t\t\t\t\t\t\t<template #content="props">\n\t\t\t\t\t\t\t\t\t\t<sw-text-field name="NovalnetPayment.settings.callbackUrl"\n\t\t\t\t\t\t\t\t\t\t\t\t\t   v-model="NovalnetPaymentCallBackUrl"\n\t\t\t\t\t\t\t\t\t\t\t\t\t   class="novalnet-payment-callback-field"\n\t\t\t\t\t\t\t\t\t\t\t\t\t   :mapInheritance="props"\n\t\t\t\t\t\t\t\t\t\t\t\t\t   :disabled="true"\n\t\t\t\t\t\t\t\t\t\t\t\t\t   :label="$tc(\'novalnet-payment.settingForm.merchantSettings.callbackUrl.label\')"\n\t\t\t\t\t\t\t\t\t\t\t\t\t   :helpText="$tc(\'novalnet-payment.settingForm.merchantSettings.callbackUrl.tooltipText\')"\n\t\t\t\t\t\t\t\t\t\t\t\t\t   @change="props.updateCurrentValue">\n\t\t\t\t\t\t\t\t\t\t</sw-text-field>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</sw-inherit-wrapper>\n\t\t\t\t\t\t\t\t<sw-button-process :disabled="false" :isLoading="buttonLoad" @click="configureWebhookUrl()" >\n\t\t\t\t\t\t\t\t\t\t\t{{ $tc(\'novalnet-payment.settingForm.merchantSettings.callbackUrl.button\') }}\n\t\t\t\t\t\t\t\t</sw-button-process>\n\t\t\t\t\t\t\t\t<sw-inherit-wrapper v-model="actualConfigData[\'NovalnetPayment.settings.deactivateIp\']"\n\t\t\t\t\t\t\t\t\t\t\t\t\t:inheritedValue="selectedSalesChannelId == null ? null : allConfigs[\'null\'][\'NovalnetPayment.settings.deactivateIp\']"\n\t\t\t\t\t\t\t\t\t\t\t\t\t:customInheritationCheckFunction="checkBoolFieldInheritance">\n\t\t\t\t\t\t\t\t\t<template #content="props">\n\t\t\t\t\t\t\t\t\t\t<sw-switch-field name="NovalnetPayment.settings.deactivateIp"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t :mapInheritance="props"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t :label="$tc(\'novalnet-payment.settingForm.merchantSettings.deactivateIp.label\')"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t :helpText="$tc(\'novalnet-payment.settingForm.merchantSettings.deactivateIp.tooltipText\')"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t :disabled="props.isInherited || !acl.can(\'novalnet_payment.editor\')"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t :value="props.currentValue"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t @change="props.updateCurrentValue">\n\t\t\t\t\t\t\t\t\t\t</sw-switch-field>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</sw-inherit-wrapper>\n\t\t\t\t\t\t\t\t<sw-inherit-wrapper v-model="actualConfigData[\'NovalnetPayment.settings.mailTo\']"\n\t\t\t\t\t\t\t\t\t\t\t\t\t:inheritedValue="selectedSalesChannelId == null ? null : allConfigs[\'null\'][\'NovalnetPayment.settings.mailTo\']"\n\t\t\t\t\t\t\t\t\t\t\t\t\t:customInheritationCheckFunction="checkTextFieldInheritance">\n\t\t\t\t\t\t\t\t\t<template #content="props">\n\t\t\t\t\t\t\t\t\t\t<sw-text-field name="NovalnetPayment.settings.mailTo"\n\t\t\t\t\t\t\t\t\t\t\t\t\t   :mapInheritance="props"\n\t\t\t\t\t\t\t\t\t\t\t\t\t   :label="$tc(\'novalnet-payment.settingForm.merchantSettings.mailTo.label\')"\n\t\t\t\t\t\t\t\t\t\t\t\t\t   :helpText="$tc(\'novalnet-payment.settingForm.merchantSettings.mailTo.tooltipText\')"\n\t\t\t\t\t\t\t\t\t\t\t\t\t   :disabled="props.isInherited || !acl.can(\'novalnet_payment.editor\')"\n\t\t\t\t\t\t\t\t\t\t\t\t\t   :value="props.currentValue"\n\t\t\t\t\t\t\t\t\t\t\t\t\t   @change="props.updateCurrentValue">\n\t\t\t\t\t\t\t\t\t\t</sw-text-field>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</sw-inherit-wrapper>\n\t\t\t\t\t\t\t{% endblock %}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{% endblock %}\n\t\t\t\t</sw-container>\n\t\t\t{% endblock %}\n\t\t</sw-card>\n\t</div>\n</sw-card-view>\n{% endblock %}\n',mixins:[f.getByName("notification"),f.getByName("sw-inline-snippet")],name:"NovalnetPaymentCredentials",icon:"default-action-settings",props:{actualConfigData:{type:Object,required:!0},allConfigs:{type:Object,required:!0},selectedSalesChannelId:{required:!0},domain:{type:String,required:!0,default:""}},data:function(){return{allConfigs:{},config:{},tariffOptions:[],actualConfigData:{},shouldDisable:!1,projectMode:!1,apiActivationKey:"",paymentAccessKey:"",tariffId:"",isLoading:!1,isRequested:"",showMessage:!1,buttonLoad:!1,NovalnetPaymentCallBackUrl:(window.location.protocol+"//"+window.location.host+window.location.pathname).split("/admin").join("")+"/novalnet/callback",generalInformation:this.$tc("novalnet-payment.module.generalInfo"),PaymentConfiguration:this.$tc("novalnet-payment.module.PaymentConfiguration")}},inject:["repositoryFactory","NovalPaymentApiCredentialsService","systemConfigApiService","acl"],watch:{actualConfigData:{handler:function(t){t&&this.$emit("input",t)},deep:!0}},computed:{actualConfigData:{get:function(){return this.allConfigs[this.selectedSalesChannelId]},set:function(t){this.allConfigs=d(d({},this.allConfigs),{},m({},this.selectedSalesChannelId,t))}}},created:function(){this.createdComponent()},updated:function(){this.createdComponent()},methods:{checkTextFieldInheritance:function(t){return"string"!=typeof t||t.length<=0},checkBoolFieldInheritance:function(t){return"boolean"!=typeof t},checkNumberFieldInheritance:function(t){return"int"!=typeof t},onCheckApi:function(){"NovalnetPayment.settings.clientId"===event.target.name?this.apiActivationKey=this.actualConfigData["NovalnetPayment.settings.clientId"]=event.target.value:"NovalnetPayment.settings.accessKey"===event.target.name&&(this.paymentAccessKey=this.actualConfigData["NovalnetPayment.settings.accessKey"]=event.target.value),""!==this.apiActivationKey||""!==this.paymentAccessKey?(this.isRequested="",this.showMessage=!0,this.createdComponent()):this.createNotificationError({title:this.$tc("novalnet-payment.settingForm.titleError"),message:this.$tc("novalnet-payment.settingForm.apiFailureMessage")})},createdComponent:function(){var t=this,e=this;void 0!==this.actualConfigData&&this.isRequested!==this.selectedSalesChannelId&&(this.isRequested=this.selectedSalesChannelId,this.apiActivationKey=this.actualConfigData["NovalnetPayment.settings.clientId"]||this.allConfigs.null["NovalnetPayment.settings.clientId"],this.paymentAccessKey=this.actualConfigData["NovalnetPayment.settings.accessKey"]||this.allConfigs.null["NovalnetPayment.settings.accessKey"],void 0!==this.apiActivationKey&&""!==this.apiActivationKey&&void 0!==this.paymentAccessKey&&""!==this.paymentAccessKey&&(this.apiActivationKey=this.apiActivationKey.replace(/\s/g,""),this.paymentAccessKey=this.paymentAccessKey.replace(/\s/g,""),this.isLoading=!0,this.NovalPaymentApiCredentialsService.validateApiCredentials(this.apiActivationKey,this.paymentAccessKey).then((function(n){var a=n.serverResponse.result.status_code;t.isLoading=!1,100!==a?(!0===t.showMessage&&t.createNotificationError({title:t.$tc("novalnet-payment.settingForm.titleError"),message:n.serverResponse.result.status_text,autoClose:!0}),t.showMessage=!1):(e.tariffOptions=[],n.tariffResponse.forEach((function(a){t.actualConfigData["NovalnetPayment.settings.clientKey"]=n.serverResponse.merchant.client_key,e.tariffOptions.push({value:a.id,label:a.name}),void 0!==t.tariffId&&""!==t.tariffId||(t.tariffId=a.id),!0===t.showMessage&&t.createNotificationSuccess({title:t.$tc("novalnet-payment.settingForm.titleSuccess"),message:t.$tc("novalnet-payment.settingForm.successMessage"),autoClose:!0}),t.showMessage=!1,1===n.serverResponse.merchant.test_mode&&(t.projectMode=!0)})))})).catch((function(e){t.isLoading=!1}))))},configureWebhookUrl:function(){var t=this,e=this.apiActivationKey||this.actualConfigData["NovalnetPayment.settings.clientKey"],n=this.paymentAccessKey||this.actualConfigData["NovalnetPayment.settings.accessKey"];if(void 0!==e&&""!==e&&void 0!==n&&""!==n){if(this.NovalnetPaymentCallBackUrl){if(!1===/^(http|https):\/\/[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,}(:[0-9]{1,5})?(\/.*)?$/i.test(this.NovalnetPaymentCallBackUrl))return this.createNotificationError({message:this.$tc("novalnet-payment.settingForm.webhookUrlFailure")}),!1;this.buttonLoad=!0,this.NovalPaymentApiCredentialsService.configureWebhookUrl(this.NovalnetPaymentCallBackUrl,e,n).then((function(e){void 0!==e.result.status&&null!=e.result.status&&""!==e.result.status&&"SUCCESS"===e.result.status?t.createNotificationSuccess({message:t.$tc("novalnet-payment.settingForm.webhookUrlSuccess")}):void 0!==e.result.status_text&&null!=e.result.status_text&&""!==e.result.status_text?t.createNotificationError({message:e.result.status_text}):t.createNotificationError({message:t.$tc("novalnet-payment.settingForm.webhookUrlFailure")}),t.buttonLoad=!1})).catch((function(e){t.buttonLoad=!1}))}}else this.createNotificationError({title:this.$tc("novalnet-payment.settingForm.titleError"),message:this.$tc("novalnet-payment.settingForm.apiFailureMessage")})}}});Shopware.Component.register("novalnet-payment-settings-icon",{template:'{% block novalnet_payment_settings_icon %}\n    <img class="sw-settings-index__novalnet-payment-icon" :src="\'novalnetpayment/administration/plugin.png\' | asset">\n{% endblock %}\n'});n("nZI3");var y=Shopware,v=y.Component,g=y.Mixin,b=(y.Filter,y.Context),_=Shopware.Data.Criteria,w=Shopware.Utils.format.currency;v.override("sw-order-detail-base",{template:'{% block sw_order_detail_customer_comment_card %}\n\t{% parent %}\n\t<template v-if="!isLoading" :isLoading="isLoading">\n        <template v-if="isNovalnetPayment">\n\t\t\t<sw-card :title="$tc(\'novalnet-payment.module.title\')" rows="2"  :isLoading="isLoading"  >\n\t\t\t\t<sw-container columns="1fr 1fr" class="novalnet-payment-order-page" >\n\t\t\t\t\t<div class = "novalnet-payment-buyer-notification">\n\t\t\t\t\t\t{% block novalnet_payment_order_notification_details_info %}\n\t\t\t\t\t\t\t<div class="novalnet-payment-buyer-notification-icon-container" align="center">\n\t\t\t\t\t\t\t\t<img class="novalnet-payment-buyer-info-icon"\n\t\t\t\t\t\t\t\t\t:src="\'novalnetpayment/static/img/plugin.png\' | asset">\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{% endblock %}\n\t\t\t\t\t\t\n\t\t\t\t\t\t{% block novalnet_payment_order_buyer_info_name_container %}\n\t\t\t\t\t\t\t<div class="novalnet-payment-buyer-info-name" >\n\n\t\t\t\t\t\t\t\t{% block novalnet_payment_order_buyer_info_name_container_name %}\n\t\t\t\t\t\t\t\t\t<div  class="novalnet-payment-buyer-info-full-name" >\n\t\t\t\t\t\t\t\t\t\t{{ order.orderCustomer.firstName }} {{ order.orderCustomer.lastName }}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t{% endblock %}\n\n\t\t\t\t\t\t\t\t{% block novalnet_payment_order_buyer_info_name_container_email %}\n\t\t\t\t\t\t\t\t\t<div  class="novalnet-payment-buyer-info-email">\n\t\t\t\t\t\t\t\t\t\t{{ order.orderCustomer.email }}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t{% endblock %}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{% endblock %}\n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t\t<sw-container class="novalnet-payment-amount-info" rows="4" columns="1fr">\n\t\t\t\t\t\t\n\t\t\t\t\t\t{% block novalnet_payment_order_component_amount_info %}\n\t\t\t\t\t\t\t<div class="novalnet-payment-amount-info-total-amount" align="right">\n\t\t\t\t\t\t\t\t{{ orderTotalAmount }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{% endblock %}\n\t\t\t\t\t\t\n\t\t\t\t\t\t{% block novalnet_payment_component_amount_info_card %}\n\t\t\t\t\t\t\t<sw-card :isLoading="isLoading"\n\t\t\t\t\t\t\t\t:hero="true" class="novalnet-payment-amount-info-amount">\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t{% block novalnet_payment_amount_info_captured_amount %}\n\t\t\t\t\t\t\t\t\t<div class="novalnet-payment-amount-captured-amount" align="right">\n\n\t\t\t\t\t\t\t\t\t\t{% block novalnet_payment_amount_info_captured_amount %}\n\t\t\t\t\t\t\t\t\t\t\t+ {{ orderPaidAmount }}\n\t\t\t\t\t\t\t\t\t\t{% endblock %}\n\n\t\t\t\t\t\t\t\t\t\t{% block novalnet_payment_amount_info_captured_amount_help %}\n\t\t\t\t\t\t\t\t\t\t\t<sw-help-text class="novalnet-payment-captured-amount-help-icon"\n\t\t\t\t\t\t\t\t\t\t\t\t\ttooltipPosition="top"\n\t\t\t\t\t\t\t\t\t\t\t\t\t:text="$tc(\'novalnet-payment.settingForm.extension.paidTooltip\')">\n\t\t\t\t\t\t\t\t\t\t\t</sw-help-text>\n\t\t\t\t\t\t\t\t\t\t{% endblock %}\n\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t{% endblock %}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t{% block novalnet_payment_order_compoenent_amount_info_refuned %}\n\t\t\t\t\t\t\t\t\t<div class="novalnet-payment-refuned-amount" align="right">\n\n\t\t\t\t\t\t\t\t\t\t{% block novalnet_payment_order_compoenent_amount_info_refuned_amount %}\n\t\t\t\t\t\t\t\t\t\t\t\t- {{ orderRefundedAmount }}\n\t\t\t\t\t\t\t\t\t\t{% endblock %}\n\n\t\t\t\t\t\t\t\t\t\t{% block novalnet_payment_order_compoenent_amount_info_refuned_help %}\n\t\t\t\t\t\t\t\t\t\t\t<sw-help-text class="novalnet-payment-refuned-amount-help-icon"\n\t\t\t\t\t\t\t\t\t\t\t\ttooltipPosition="top"\n\t\t\t\t\t\t\t\t\t\t\t\t:text="$tc(\'novalnet-payment.settingForm.extension.refundTooltip\')">\n\t\t\t\t\t\t\t\t\t\t\t</sw-help-text>\n\t\t\t\t\t\t\t\t\t\t{% endblock %}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t{% endblock %}\n\t\t\t\t\t\t\t</sw-card>\n\t\t\t\t\t\t{% endblock %}\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t{% block novalnet_payment_order_info_date %}\n\t\t\t\t\t\t\t<div class="novalnet-payment-amount-info-charge-date" align="right">\n\t\t\t\t\t\t\t\t\t {{ transaction.createdAt|date(\'d.m.y\') }} \n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{% endblock %}\t \t\t \n\t\t\t\t\t\t\t\t\t \n\t\t\t\t\t</sw-container>\n\t\t\t\t\t\n\t\t\t\t\t<sw-container class="novalnet-payment-action-toolbar" rows="1" columns="1fr 1fr 1fr" gap="10px">\n\n\t\t\t\t\t\t{% block novalnet_payment_order_container_toolbar_refund_button %}\n\t\t\t\t\t\t\t<sw-button size="small"\n\t\t\t\t\t\t\t\t\tclass="novalnet-payment-pay-action-toolbar__button"\n\t\t\t\t\t\t\t\t\tv-if="canRefund"\n\t\t\t\t\t\t\t\t\t:disabled="!acl.can(\'novalnet_extension.editor\')"\n\t\t\t\t\t\t\t\t\t@click="showRefundModal"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{{ $tc(\'novalnet-payment.settingForm.extension.refundButton\') }}\n\t\t\t\t\t\t\t</sw-button>\n\t\t\t\t\t\t{% endblock %}\n\t\t\t\t\t\t\n\t\t\t\t\t\t{% block novalnet_payment_order_container_toolbar_capture_button %}\n\t\t\t\t\t\t\t<sw-button size="small"\n\t\t\t\t\t\t\t\t\t   class="novalnet-payment-pay-action-toolbar__button"\n\t\t\t\t\t\t\t\t\t   v-if="canCaptureVoid"\n\t\t\t\t\t\t\t\t\t   :disabled="!acl.can(\'novalnet_extension.editor\')"\n\t\t\t\t\t\t\t\t\t   @click="showConfirmModal">\n\t\t\t\t\t\t\t\t{{ $tc(\'novalnet-payment.settingForm.extension.confirmLabel\') }}\n\t\t\t\t\t\t\t</sw-button>\n\t\t\t\t\t\t{% endblock %}\n\n\t\t\t\t\t\t{% block novalnet_payment_order_container_toolbar_cancel_button %}\n\t\t\t\t\t\t\t<sw-button size="small"\n\t\t\t\t\t\t\t\t\t   class="novalnet-payment-pay-action-toolbar__button"\n\t\t\t\t\t\t\t\t\t   v-if="canCaptureVoid"\n\t\t\t\t\t\t\t\t\t   :disabled="!acl.can(\'novalnet_extension.editor\')"\n\t\t\t\t\t\t\t\t\t   @click="showCancelModal">\n\t\t\t\t\t\t\t\t{{ $tc(\'novalnet-payment.settingForm.extension.cancelLabel\') }}\n\t\t\t\t\t\t\t</sw-button>\n\t\t\t\t\t\t{% endblock %}\n\t\t\t\t\t\t\n\t\t\t\t\t\t{% block novalnet_payment_order_container_toolbar_instalment_cancel_button %}\n                            <sw-button size="small"\n                                       class="novalnet-payment-pay-action-toolbar__button"\n                                       v-if="canInstalmentCancel"\n                                       :disabled="!acl.can(\'novalnet_extension.editor\')"\n                                       @click="showInstalmentCancelModal">\n                                {{ $tc(\'novalnet-payment.settingForm.extension.instalmentCancelLabel\') }}\n                            </sw-button>\n                        {% endblock %}\n               \n                        {% block novalnet_payment_order_container_toolbar_instalment_all_cancel_button %}\n                            <sw-button size="small"\n                                       class="novalnet-payment-pay-action-toolbar__button"\n                                       v-if="canInstalmentAllCancel"\n                                       :disabled="!acl.can(\'novalnet_extension.editor\')"\n                                       @click="showInstalmentAllCancelModal">\n                                {{ $tc(\'novalnet-payment.settingForm.extension.instalmentAllCancelLabel\') }}\n                            </sw-button>\n                        {% endblock %}\n                        \n                        {% block novalnet_payment_order_container_toolbar_instalment_remain_cancel_button %}\n                            <sw-button size="small"\n                                       class="novalnet-payment-pay-action-toolbar__button"\n                                       v-if="canInstalmentRemainCancel"\n                                       :disabled="!acl.can(\'novalnet_extension.editor\')"\n                                       @click="showInstalmentRemainCancelModal">\n                                {{ $tc(\'novalnet-payment.settingForm.extension.instalmentRemainCancelLabel\') }}\n                            </sw-button>\n                        {% endblock %}\n                        \n                        {% block novalnet_payment_order_container_toolbar_zero_amount_button %}\n\t\t\t\t\t\t\t<sw-button size="small"\n\t\t\t\t\t\t\t\t\t   class="novalnet-payment-pay-action-toolbar__button"\n\t\t\t\t\t\t\t\t\t   v-if="canZeroAmountBooking"\n\t\t\t\t\t\t\t\t\t   :disabled="!acl.can(\'novalnet_extension.editor\')"\n\t\t\t\t\t\t\t\t\t   @click="showZeroAmountBlock">\n\t\t\t\t\t\t\t\t{{ $tc(\'novalnet-payment.settingForm.extension.zeroAmountButton\') }}\n\t\t\t\t\t\t\t</sw-button>\n\t\t\t\t\t\t{% endblock %}\n\t\t\t\t\t</sw-container>\n\t\t\t\t</sw-container>\n        \n\t\t\t\t<sw-container columns="1fr"\n                    class="sw-card-section sw-card-section--secondary"\n                    slot="grid">\n                    \n\t\t\t\t\t<sw-container class="novalnet-payment-pay-info-container" columns="1fr 1fr" rows="2">\n\n\t\t\t\t\t\t{% block novalnet_payment_order_component_checkout_info_billing_container %}\n\t\t\t\t\t\t\t<div class="novalnet-payment_chechout-info-billing_container" v-if="isNovalnetPayment">\n\t\t\t\t\t\t\t\t{% block novalnet_payment_order_component_checkout_info_billing_container_headline %}\n\t\t\t\t\t\t\t\t\t<div class="novalnet-payment-checkout-info-header">\n\t\t\t\t\t\t\t\t\t\t{{ $tc(\'novalnet-payment.module.comments\') }}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t{% endblock %}\n\n\t\t\t\t\t\t\t\t{% block novalnet_payment_order_component_billing_value %}\n\t\t\t\t\t\t\t\t\t<span class="novalnet-payment-checkout-info-comments" v-html="novalnetComments">\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t{% endblock %}\n\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{% endblock %}\n\n\t\t\t\t\t\t{% block novalnet_payment_order_componenet_checkout_info_status_container %}\n\t\t\t\t\t\t\t<div class="novalnet-payment-status-container">\n\t\t\t\t\t\t\t\t{% block novalnet_payment_order_component_status_container %}\n\t\t\t\t\t\t\t\t\t<div class="novalnet-payment-checkout-info-header">\n\t\t\t\t\t\t\t\t\t\t{{ $tc(\'novalnet-payment.settingForm.statusTitle\') }}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t{% endblock %}\n\n\t\t\t\t\t\t\t\t{% block novalnet_payment_order_component_checkout_status_info_container_value %}\n\t\t\t\t\t\t\t\t\t<div class="novalnet-payment-checkout-status-info">\n\t\t\t\t\t\t\t\t\t\t{{ stateMachineState }}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t{% endblock %}\n\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{% endblock %}\n\t\t\t\t\t\t\n\t\t\t\t\t\t{% block novalnet_payment_order_component_action_toolbar_modals %}\n\t\t\t\t\t\t\t<novalnet-payment-refund-modal\n\t\t\t\t\t\t\t\tv-if="refundModalVisible"\n\t\t\t\t\t\t\t\t:refundableAmount="refundableAmount"\n\t\t\t\t\t\t\t\t:order="order"\n\t\t\t\t\t\t\t\t:item="item"\n\t\t\t\t\t\t\t\t@modal-close="closeModals"\n\t\t\t\t\t\t\t\t@reload-payment="reloadPaymentDetails">\n\t\t\t\t\t\t\t</novalnet-payment-refund-modal>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t<novalnet-payment-manage-transaction-modal\n\t\t\t\t\t\t\t\tv-if="confirmModalVisible"\n\t\t\t\t\t\t\t\t:status="status"\n\t\t\t\t\t\t\t\t:order="order"\n\t\t\t\t\t\t\t\t@modal-close="closeModals"\n\t\t\t\t\t\t\t\t@reload-payment="reloadPaymentDetails">\n\t\t\t\t\t\t\t</novalnet-payment-manage-transaction-modal>\n\n\t\t\t\t\t\t\t<novalnet-payment-manage-transaction-modal\n\t\t\t\t\t\t\t\tv-if="cancelModalVisible"\n\t\t\t\t\t\t\t\t:status="status"\n\t\t\t\t\t\t\t\t:order="order"\n\t\t\t\t\t\t\t\t@modal-close="closeModals"\n\t\t\t\t\t\t\t\t@reload-payment="reloadPaymentDetails">\n\t\t\t\t\t\t\t</novalnet-payment-manage-transaction-modal>\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t<novalnet-payment-instalment-cancel-modal\n\t\t\t\t\t\t\t\tv-if="instalmentRefundModalVisible"\n\t\t\t\t\t\t\t\t:item="item"\n\t\t\t\t\t\t\t\t:cancelType="cancelType"\n\t\t\t\t\t\t\t\t:order="order"\n\t\t\t\t\t\t\t\t@modal-close="closeModals"\n\t\t\t\t\t\t\t\t@reload-payment="reloadPaymentDetails">\n\t\t\t\t\t\t\t</novalnet-payment-instalment-cancel-modal>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t<novalnet-payment-book-amount-modal\n\t\t\t\t\t\t\t\tv-if="zeroAmountVisible"\n\t\t\t\t\t\t\t\t:orderAmount="orderAmount"\n\t\t\t\t\t\t\t\t:order="order"\n\t\t\t\t\t\t\t\t@modal-close="closeModals"\n\t\t\t\t\t\t\t\t@reload-payment="reloadPaymentDetails">\n\t\t\t\t\t\t\t</novalnet-payment-book-amount-modal>\n\t\t\t\t\t\t{% endblock %}\n\n\t\t\t\t\t</sw-container>\n\t\t\t\t</sw-card>\n\t\t\t\t\n\t\t\t\t<sw-card :title="$tc(\'novalnet-payment.settingForm.instalmentInfo\')" v-if="canInstalmentShow">\n\t\t\t\t\t<template #grid>\n\t\t\t\t\t\t<sw-data-grid\n\t\t\t\t\t\t\t:dataSource="InstalmentInfo"\n\t\t\t\t\t\t\t:columns="getInstalmentColums"\n\t\t\t\t\t\t\t:compactMode="false"\n\t\t\t\t\t\t\t:allowInlineEdit="false"\n\t\t\t\t\t\t\t:showSelection="false">\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t{% block sw_product_detail_base_actions %}\n\t\t\t\t\t\t\t\t<template #actions="{ item }">\n\t\t\t\t\t\t\t\t\t{% block sw_product_detail_base_actions_edit %}\n\t\t\t\t\t\t\t\t\t\t<sw-context-menu-item\n\t\t\t\t\t\t\t\t\t\t\tclass="sw-product-detail-base__review-edit"\n\t\t\t\t\t\t\t\t\t\t\t@click="instalmentRefund(item)"\n\t\t\t\t\t\t\t\t\t\t\t:disabled="disableInstalmentRefund(item)">\n\t\t\t\t\t\t\t\t\t\t\t{{ $tc(\'novalnet-payment.settingForm.extension.refundButton\') }}\n\t\t\t\t\t\t\t\t\t\t</sw-context-menu-item>\n\t\t\t\t\t\t\t\t\t{% endblock %}\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t{% endblock %}\n\n\n\t\t\t\t\t\t</sw-data-grid>\n\t\t\t\t\t</template>\n            </sw-card>\n\t\t\t\n        \n        </template>\n    </template>\n\n{% endblock %}\n',inject:["NovalPaymentApiCredentialsService","repositoryFactory","acl"],mixins:[g.getByName("notification")],props:{orderId:{type:String,required:!0},paymentDetails:{type:Object,required:!0}},data:function(){return{isLoading:!1,order:{},orderAmount:0,isNovalnetPayment:!1,stateMachineState:null,novalnetComments:"",orderTotalAmount:"",orderPaidAmount:0,orderRefundedAmount:0,canRefund:!1,refundModalVisible:!1,confirmModalVisible:!1,cancelModalVisible:!1,item:{},status:0,canCaptureVoid:!1,refundableAmount:0,canInstalmentShow:!1,InstalmentInfo:[],cancelType:"",canInstalmentCancel:!1,canInstalmentAllCancel:!1,canInstalmentRemainCancel:!1,instalmentRefundAmount:0,instalmentRefundModalVisible:!1,canZeroAmountBooking:!1,zeroAmountVisible:!1,payLater:["INVOICE","CASHPAYMENT","MULTIBANCO","PREPAYMENT"],instalmentPayments:["INSTALMENT_INVOICE","INSTALMENT_DIRECT_DEBIT_SEPA"],onholdStatus:["91","99","98","85"]}},computed:{getInstalmentColums:function(){return[{property:"number",dataIndex:"number",label:this.$tc("novalnet-payment.settingForm.instalmentNumber"),width:"50px"},{property:"reference",dataIndex:"reference",label:this.$tc("novalnet-payment.settingForm.instalmentReference"),width:"120px"},{property:"amount",dataIndex:"amount",label:this.$tc("novalnet-payment.settingForm.instalmentAmount"),width:"80px"},{property:"totalAmount",dataIndex:"totalAmount",visible:!1},{property:"refundAmount",dataIndex:"refundAmount",visible:!1},{property:"nextCycle",dataIndex:"nextCycle",label:this.$tc("novalnet-payment.settingForm.instalmentDate"),width:"120px"},{property:"status",dataIndex:"status",label:this.$tc("novalnet-payment.settingForm.instalmentStatus"),width:"80px"}]}},watch:{orderId:{deep:!0,handler:function(){var t=this;if(this.orderId){var e=this.repositoryFactory.create("order"),n=new _(1,1);n.addAssociation("transactions"),n.addAssociation("currency"),n.addFilter(_.equals("id",this.orderId)),e.search(n,b.api).then((function(e){var n=e.first();if(n){t.identifier||(t.identifier=n.orderNumber);var a=!1,o="",i=t.$tc("novalnet-payment.module.comments");n.transactions.sort((function(t,e){return new Date(e.createdAt)-new Date(t.createdAt)})).forEach((function(e){if(e.customFields&&e.customFields.novalnet_comments)return t.stateMachineState=e.stateMachineState.name,a=!0,""!=o&&(o+="<dt>"+i+"</dt>"),o+=e.customFields.novalnet_comments.split("/ ").join("<br />"),!0})),a?(t.novalnetComments=o.split("&&").join("<dt><strong>"+i+"</strong></dt>"),t.setNovalnetPayment(!0),t.isNovalnetPayment=!0):(t.setNovalnetPayment(!1),t.isNovalnetPayment=!1),t.canRefund=!1,t.canCaptureVoid=!1,t.canInstalmentShow=!1,t.InstalmentInfo=[],t.canInstalmentCancel=!1,t.canZeroAmountBooking=!1,t.canInstalmentAllCancel=!1,t.canInstalmentRemainCancel=!1,t.NovalPaymentApiCredentialsService.getNovalnetAmount(n.orderNumber).then((function(e){if(""!=e.data&&null!=e.data&&e.data.gatewayStatus){t.refundableAmount=Number(e.data.amount)-Number(e.data.refundedAmount),t.orderAmount=Math.round(100*Number(n.price.totalPrice)),0!=e.data.amount?t.orderTotalAmount=w(e.data.amount/100,n.currency.shortName):t.orderTotalAmount=w(n.price.totalPrice,n.currency.shortName),0!=e.data.paidAmount?t.orderPaidAmount=w(e.data.paidAmount/100,n.currency.shortName):t.orderPaidAmount=w(0,n.currency.shortName),0!=e.data.refundedAmount?t.orderRefundedAmount=w(e.data.refundedAmount/100,n.currency.shortName):t.orderRefundedAmount=w(0,n.currency.shortName);var a=JSON.parse(e.data.additionalDetails);if((e.data.amount>0&&"CONFIRMED"==e.data.gatewayStatus&&!t.instalmentPayments.includes(e.data.paymentType)&&Number(e.data.refundedAmount)<Number(e.data.amount)||"PENDING"==e.data.gatewayStatus&&t.payLater.includes(e.data.paymentType))&&"MULTIBANCO"!=e.data.paymentType?t.canRefund=!0:"ON_HOLD"==e.data.gatewayStatus||t.onholdStatus.includes(e.data.gatewayStatus)?t.canCaptureVoid=!0:t.instalmentPayments.includes(e.data.paymentType)&&"CONFIRMED"==e.data.gatewayStatus&&!a.cancelType?t.canInstalmentCancel=!0:"CREDITCARD"!=e.data.paymentType&&"DIRECT_DEBIT_SEPA"!=e.data.paymentType&&"GOOGLEPAY"!=e.data.paymentType&&"DIRECT_DEBIT_ACH"!=e.data.paymentType||0!=Number(e.data.amount)||0==t.orderAmount||(t.canZeroAmountBooking=!0),"CONFIRMED"==e.data.gatewayStatus&&t.instalmentPayments.includes(e.data.paymentType)&&""!=a.InstalmentDetails){t.canInstalmentShow=!0,t.instalmentRefundAmount=e.data.refundedAmount;var o=1;Object.values(a.InstalmentDetails).forEach((function(e){t.InstalmentInfo.push({nextCycle:e.cycleDate,amount:w(e.amount/100,n.currency.shortName),reference:e.reference,status:e.status,totalAmount:e.amount,refundAmount:e.refundAmount,number:o}),o++})),0!=e.data.refundedAmount&&(t.canInstalmentCancel=!1,t.canInstalmentAllCancel=!1),null!=t.InstalmentInfo&&null!=t.InstalmentInfo&&t.InstalmentInfo.forEach((function(e){""!=e.reference&&null!=e.reference||(t.canInstalmentRemainCancel=!0)})),null!=a.cancelType&&""!=a.cancelType&&(t.canInstalmentRemainCancel=!1),0==t.canInstalmentRemainCancel&&0==e.data.refundedAmount?(t.canInstalmentCancel=!1,t.canInstalmentAllCancel=!0):1==t.canInstalmentCancel&&(t.canInstalmentRemainCancel=!1)}}}))}})).finally((function(){t.setNovalnetPayment(!1)}))}else this.setNovalnetPayment(null)},immediate:!0}},methods:{setNovalnetPayment:function(t){t&&(this.isNovalnetPayment=t)},showRefundModal:function(){this.refundModalVisible=!0},showConfirmModal:function(){this.status=100,this.confirmModalVisible=!0},showCancelModal:function(){this.status=103,this.cancelModalVisible=!0},instalmentRefund:function(t){this.refundableAmount=t.totalAmount-t.refundAmount,this.item=t,this.refundModalVisible=!0},disableInstalmentRefund:function(t){return null==t.reference||""==t.reference||t.refundAmount>=t.totalAmount||!this.acl.can("novalnet_extension.editor")},showInstalmentCancelModal:function(){var t=this;null!=this.InstalmentInfo&&null!=this.InstalmentInfo&&this.InstalmentInfo.forEach((function(e){""!=e.reference&&null!=e.reference||(t.canInstalmentRemainCancel=!0)})),0==this.instalmentRefundAmount&&(this.canInstalmentAllCancel=!0),this.canInstalmentCancel=!1},showInstalmentAllCancelModal:function(){this.instalmentRefundModalVisible=!0,this.cancelType="CANCEL_ALL_CYCLES"},showInstalmentRemainCancelModal:function(){this.instalmentRefundModalVisible=!0,this.cancelType="CANCEL_REMAINING_CYCLES"},showZeroAmountBlock:function(){this.zeroAmountVisible=!0},closeModals:function(){this.refundModalVisible=!1,this.confirmModalVisible=!1,this.cancelModalVisible=!1,this.instalmentRefundModalVisible=!1,this.zeroAmountVisible=!1},reloadPaymentDetails:function(){var t=this;this.closeModals(),this.$nextTick().then((function(){t.$emit("reload-payment")}))}}});n("oguu");var C=Shopware,k=C.Context,N=C.Component,S=(C.Filter,C.Utils,Shopware.Data.Criteria),A=Shopware.Utils.format.currency;N.override("sw-order-detail-details",{template:'{% block sw_order_detail_details_payment %}\n\t\n\t\n\t<sw-order-details-state-card\n        v-if="transaction"\n        :title="$tc(\'sw-order.detailsTab.labelTransactionCard\')"\n        :order="order"\n        :entity="transaction"\n        :state-label="$tc(\'sw-order.stateCard.headlineTransactionState\')"\n        :disabled="!acl.can(\'order.editor\')"\n        @show-status-history="showStateHistoryModal = true"\n        @save-edits="onSaveEdits"\n    >\n\n        \n        {% block sw_order_detail_details_payment_billing_address %}\n        <sw-order-address-selection\n            class="sw-order-detail-details__billing-address"\n            type="billing"\n            :address="billingAddress"\n            :address-id="selectedBillingAddressId"\n            :disabled="!acl.can(\'order.editor\')"\n            :label="$tc(\'sw-order.createBase.detailsBody.labelBillingAddress\')"\n            @change-address="onChangeOrderAddress"\n        />\n        {% endblock %}\n\n        \n        {% block sw_order_detail_details_payment_method_select %}\n        \n\t\t\t{% if paymentMethod !=\'\' %}\n\t\t\t\t<sw-text-field type="text"\n\t\t\t\t\t:label="$tc(\'sw-order.createBase.detailsFooter.labelPaymentMethod\')" \n\t\t\t\t\t:placeholder="$tc(\'sw-order.createBase.detailsFooter.placeholderPaymentMethod\')"\n\t\t\t\t\t:disabled="true"\n\t\t\t\t\tv-model="paymentMethod"\n\t\t\t\t\t> \n\t\t\t\t</sw-text-field>\n\t\t\t{% else %}\n\t\t\t\t<sw-entity-single-select\n\t\t\t\tv-model="transaction.paymentMethodId"\n\t\t\t\tentity="payment_method"\n\t\t\t\tlabel-property="distinguishableName"\n\t\t\t\tdisabled\n\t\t\t\t:criteria="paymentMethodCriteria"\n\t\t\t\t:label="$tc(\'sw-order.createBase.detailsFooter.labelPaymentMethod\')"\n\t\t\t\t:placeholder="$tc(\'sw-order.createBase.detailsFooter.placeholderPaymentMethod\')"\n\t\t\t\tshow-clearable-button\n\t\t\t\t/>\n\t\t\t{% endif %}\t\n        \n        {% endblock %}\n\n    </sw-order-details-state-card>\n   \n\t\n\t{% block sw_order_detail_details_payment_novalnet_seaction %}\n\t\t<template v-if="isNovalnetPayment">\n\t\t\t<sw-order-details-state-card\n\t\t\t\tv-if="transaction"\n\t\t\t\t:title="$tc(\'novalnet-payment.module.title\')"\n\t\t\t\t:order="order"\n\t\t\t\t:entity="transaction"\n\t\t\t\t:state-label="$tc(\'sw-order.stateCard.headlineTransactionState\')"\n\t\t\t\t:disabled="!acl.can(\'order.editor\')"\n\t\t\t\t@show-status-history="showStateHistoryModal = true"\n\t\t\t\t@save-edits="onSaveEdits">\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t<div class="novalnet-payment-buyer-notification">\n\t\t\t\t\t{# Logo #}\n\t\t\t\t\t{% block novalnet_payment_order_buyer_info %}\n\t\t\t\t\t\t<div class="novalnet-payment-buyer-notification-icon-container" align="center">\n\t\t\t\t\t\t\t<img class="novalnet-payment-buyer-info-icon"\n\t\t\t\t\t\t\t\t :src="\'novalnetpayment/static/img/plugin.png\' | asset">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{% endblock %}\n\n\t\t\t\t\t{# Full name and E-Mail address #}\n\t\t\t\t\t{% block novalnet_payment_order_buyer_info_name_container %}\n\t\t\t\t\t\t<div class="novalnet-payment-buyer-info-name">\n\n\t\t\t\t\t\t\t{% block novalnet_payment_order_buyer_info_name_container_name %}\n\t\t\t\t\t\t\t\t<div class="novalnet-payment-buyer-info-full-name">\n\t\t\t\t\t\t\t\t\t{{ order.orderCustomer.firstName }} {{ order.orderCustomer.lastName }}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{% endblock %}\n\n\t\t\t\t\t\t\t{% block novalnet_payment_order_buyer_info_name_container_email %}\n\t\t\t\t\t\t\t\t<div class="novalnet-payment-buyer-info-email">\n\t\t\t\t\t\t\t\t\t{{ order.orderCustomer.email }}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{% endblock %}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{% endblock %}\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t\t<sw-container class="novalnet-payment-amount-info" columns="1fr">\n\t\t\t\t\t{% block novalnet_payment_order_component_amount_info %}\n\t\t\t\t\t\t<div class="novalnet-payment-amount-info-total-amount" align="right">\n\t\t\t\t\t\t\t{{ displayAmount }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{% endblock %}\n\t\t\t\t\t\n\t\t\t\t\t{% block novalnet_payment_amount_info_captured_amount %}\n\t\t\t\t\t\t<div class="novalnet-payment-amount-captured-amount" align="right">\n\n\t\t\t\t\t\t\t{% block novalnet_payment_amount_info_captured_amount %}\n\t\t\t\t\t\t\t\t+ {{ displayPaidAmount }}\n\t\t\t\t\t\t\t{% endblock %}\n\n\t\t\t\t\t\t\t{% block novalnet_payment_amount_info_captured_amount_help %}\n\t\t\t\t\t\t\t\t<sw-help-text class="novalnet-payment-captured-amount-help-icon"\n\t\t\t\t\t\t\t\t\t\t\t  tooltipPosition="top"\n\t\t\t\t\t\t\t\t\t\t\t  :text="$tc(\'novalnet-payment.settingForm.extension.paidTooltip\')">\n\t\t\t\t\t\t\t\t</sw-help-text>\n\t\t\t\t\t\t\t{% endblock %}\n\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{% endblock %}\n\t\t\t\t\t\n\t\t\t\t\t{% block novalnet_payment_order_compoenent_amount_info_refuned %}\n\t\t\t\t\t\t<div class="novalnet-payment-refuned-amount" align="right">\n\n\t\t\t\t\t\t\t{% block novalnet_payment_order_compoenent_amount_info_refuned_amount %}\n\t\t\t\t\t\t\t\t- {{ refundedAmount }}\n\t\t\t\t\t\t\t{% endblock %}\n\n\t\t\t\t\t\t\t{% block novalnet_payment_order_compoenent_amount_info_refuned_help %}\n\t\t\t\t\t\t\t\t<sw-help-text class="novalnet-payment-refuned-amount-help-icon"\n\t\t\t\t\t\t\t\t\t\t\t  tooltipPosition="top"\n\t\t\t\t\t\t\t\t\t\t\t  :text="$tc(\'novalnet-payment.settingForm.extension.refundTooltip\')">\n\t\t\t\t\t\t\t\t</sw-help-text>\n\t\t\t\t\t\t\t{% endblock %}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{% endblock %}\n\n\t\t\t\t\t{% block novalnet_payment_order_info_date %}\n\t\t\t\t\t\t<div class="novalnet-payment-amount-info-charge-date" align="right">\n\t\t\t\t\t\t\t{{ transaction.createdAt|date(\'d.m.y\') }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{% endblock %}\n\t\t\t\t</sw-container>\n\t\t\t\t\n\t\t\t\t<sw-container class="novalnet-payment-action-toolbar" rows="1" columns="1fr 1fr 1fr" gap="10px">\n\n\t\t\t\t\t{% block novalnet_payment_order_container_toolbar_refund_button %}\n\t\t\t\t\t\t<sw-button size="small"\n\t\t\t\t\t\t\t\t   class="novalnet-payment-pay-action-toolbar__button"\n\t\t\t\t\t\t\t\t   v-if="canRefund"\n\t\t\t\t\t\t\t\t   :disabled="!acl.can(\'novalnet_extension.editor\')"\n\t\t\t\t\t\t\t\t   @click="showRefundModal">\n\t\t\t\t\t\t\t{{ $tc(\'novalnet-payment.settingForm.extension.refundButton\') }}\n\t\t\t\t\t\t</sw-button>\n\t\t\t\t\t{% endblock %}\n\n                    {% block novalnet_payment_order_container_toolbar_instalment_cancel_button %}\n                        <sw-button size="small"\n                                   class="novalnet-payment-pay-action-toolbar__button"\n                                   v-if="canInstalmentCancel"\n                                   :disabled="!acl.can(\'novalnet_extension.editor\')"\n                                   @click="showInstalmentCancelModal">\n                            {{ $tc(\'novalnet-payment.settingForm.extension.instalmentCancelLabel\') }}\n                        </sw-button>\n                    {% endblock %}\n               \n                    {% block novalnet_payment_order_container_toolbar_instalment_all_cancel_button %}\n                        <sw-button size="small"\n                                   class="novalnet-payment-pay-action-toolbar__button"\n                                   v-if="canInstalmentAllCancel"\n                                   :disabled="!acl.can(\'novalnet_extension.editor\')"\n                                   @click="showInstalmentAllCancelModal">\n                            {{ $tc(\'novalnet-payment.settingForm.extension.instalmentAllCancelLabel\') }}\n                        </sw-button>\n                    {% endblock %}\n                    \n                    {% block novalnet_payment_order_container_toolbar_instalment_remain_cancel_button %}\n                        <sw-button size="small"\n                                   class="novalnet-payment-pay-action-toolbar__button"\n                                   v-if="canInstalmentRemainCancel"\n                                   :disabled="!acl.can(\'novalnet_extension.editor\')"\n                                   @click="showInstalmentRemainCancelModal">\n                            {{ $tc(\'novalnet-payment.settingForm.extension.instalmentRemainCancelLabel\') }}\n                        </sw-button>\n                    {% endblock %}\n\n\t\t\t\t\t{% block novalnet_payment_order_container_toolbar_capture_button %}\n\t\t\t\t\t\t<sw-button size="small"\n\t\t\t\t\t\t\t\t   class="novalnet-payment-pay-action-toolbar__button"\n\t\t\t\t\t\t\t\t   v-if="canCaptureVoid"\n\t\t\t\t\t\t\t\t   :disabled="!acl.can(\'novalnet_extension.editor\')"\n\t\t\t\t\t\t\t\t   @click="showConfirmModal">\n\t\t\t\t\t\t\t{{ $tc(\'novalnet-payment.settingForm.extension.confirmLabel\') }}\n\t\t\t\t\t\t</sw-button>\n\t\t\t\t\t{% endblock %}\n\n\t\t\t\t\t{% block novalnet_payment_order_container_toolbar_cancel_button %}\n\t\t\t\t\t\t<sw-button size="small"\n\t\t\t\t\t\t\t\t   class="novalnet-payment-pay-action-toolbar__button"\n\t\t\t\t\t\t\t\t   v-if="canCaptureVoid"\n\t\t\t\t\t\t\t\t   :disabled="!acl.can(\'novalnet_extension.editor\')"\n\t\t\t\t\t\t\t\t   @click="showCancelModal">\n\t\t\t\t\t\t\t{{ $tc(\'novalnet-payment.settingForm.extension.cancelLabel\') }}\n\t\t\t\t\t\t</sw-button>\n\t\t\t\t\t{% endblock %}\n\t\t\t\t\t\n\t\t\t\t\t{% block novalnet_payment_order_container_toolbar_zero_amount_button %}\n\t\t\t\t\t\t<sw-button size="small"\n\t\t\t\t\t\t\t\t   class="novalnet-payment-pay-action-toolbar__button"\n\t\t\t\t\t\t\t\t   v-if="canZeroAmountBooking"\n\t\t\t\t\t\t\t\t   :disabled="!acl.can(\'novalnet_extension.editor\')"\n\t\t\t\t\t\t\t\t   @click="showZeroAmountBlock">\n\t\t\t\t\t\t\t{{ $tc(\'novalnet-payment.settingForm.extension.zeroAmountButton\') }}\n\t\t\t\t\t\t</sw-button>\n\t\t\t\t\t{% endblock %}\n\t\t\t\t</sw-container>\n\t\t\t\t\n\t\t\t\t<sw-container class="novalnet-payment-pay-empty-container" columns="1fr">\n\t\t\t\t</sw-container>\n\t\t\t\t\n\t\t\t\t<sw-container class="novalnet-payment-pay-info-container" columns="1fr">\n\t\t\t\t\t<hr class="sw-order-detail-state-card__divider">\n\t\t\t\t\t{% block novalnet_payment_order_component_checkout_info_billing_container %}\n\t\t\t\t\t\t<div class="novalnet-payment_chechout-info-customer-comments" v-if="isNovalnetPayment" >\n\t\n\t\t\t\t\t\t\t{% block novalnet_payment_order_component_checkout_info_billing_container_headline %}\n\t\t\t\t\t\t\t\t<div class="novalnet-payment-checkout-info-header">\n\t\t\t\t\t\t\t\t\t{{ $tc(\'novalnet-payment.module.comments\') }}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{% endblock %}\n\t\n\t\t\t\t\t\t\t{% block novalnet_payment_order_component_billing_value %}\n\t\t\t\t\t\t\t\t<span class="novalnet-payment-checkout-info-comments" v-html="novalnetComments" style="line-height:22px;">\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t{% endblock %}\n\t\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{% endblock %}\n\t\t\t\t</sw-container>\n\t\t\t\t\n\t\t\t\t{% block novalnet_payment_order_component_action_toolbar_modals %}\n\t\t\t\t\t<novalnet-payment-refund-modal\n\t\t\t\t\t\tv-if="refundModalVisible"\n\t\t\t\t\t\t:refundableAmount="refundableAmount"\n\t\t\t\t\t\t:order="order"\n\t\t\t\t\t\t:item="item"\n\t\t\t\t\t\t@modal-close="closeModals"\n\t\t\t\t\t\t@reload-payment="reloadPaymentDetails">\n\t\t\t\t\t</novalnet-payment-refund-modal>\n\n\t\t\t\t\t<novalnet-payment-instalment-cancel-modal\n\t\t\t\t\t\tv-if="instalmentRefundModalVisible"\n\t\t\t\t\t\t:item="item"\n\t\t\t\t\t\t:cancelType="cancelType"\n\t\t\t\t\t\t:order="order"\n\t\t\t\t\t\t@modal-close="closeModals"\n\t\t\t\t\t\t@reload-payment="reloadPaymentDetails">\n\t\t\t\t\t</novalnet-payment-instalment-cancel-modal>\n\n\t\t\t\t\t<novalnet-payment-manage-transaction-modal\n\t\t\t\t\t\tv-if="confirmModalVisible"\n\t\t\t\t\t\t:status="status"\n\t\t\t\t\t\t:order="order"\n\t\t\t\t\t\t@modal-close="closeModals"\n\t\t\t\t\t\t@reload-payment="reloadPaymentDetails">\n\t\t\t\t\t</novalnet-payment-manage-transaction-modal>\n\n\t\t\t\t\t<novalnet-payment-manage-transaction-modal\n\t\t\t\t\t\tv-if="cancelModalVisible"\n\t\t\t\t\t\t:status="status"\n\t\t\t\t\t\t:order="order"\n\t\t\t\t\t\t@modal-close="closeModals"\n\t\t\t\t\t\t@reload-payment="reloadPaymentDetails">\n\t\t\t\t\t</novalnet-payment-manage-transaction-modal>\n\t\t\t\t\t\n\t\t\t\t\t<novalnet-payment-book-amount-modal\n\t\t\t\t\t\tv-if="zeroAmountVisible"\n\t\t\t\t\t\t:orderAmount="orderAmount"\n\t\t\t\t\t\t:order="order"\n\t\t\t\t\t\t@modal-close="closeModals"\n\t\t\t\t\t\t@reload-payment="reloadPaymentDetails">\n\t\t\t\t\t</novalnet-payment-book-amount-modal>\n\t\t\t\t{% endblock %}\n\t\t\t\t\t\n\t\t\t</sw-order-details-state-card>\n\t\t\t\n\t\t\t<sw-card :title="$tc(\'novalnet-payment.settingForm.instalmentInfo\')" v-if="canInstalmentShow">\n\t\t\t\t\t<template #grid>\n\t\t\t\t\t\t<sw-data-grid\n\t\t\t\t\t\t\t:dataSource="InstalmentInfo"\n\t\t\t\t\t\t\t:columns="getInstalmentColums"\n\t\t\t\t\t\t\t:compactMode="false"\n\t\t\t\t\t\t\t:allowInlineEdit="true"\n\t\t\t\t\t\t\t:showSelection="false">\n\n\t\t\t\t\t\t\t{% block sw_product_detail_base_ratings_actions %}\n\t\t\t\t\t\t\t\t<template #actions="{ item }">\n\t\t\t\t\t\t\t\t\t{% block sw_product_detail_base_ratings_actions_edit %}\n\t\t\t\t\t\t\t\t\t\t<sw-context-menu-item\n\t\t\t\t\t\t\t\t\t\t\tclass="sw-product-detail-base__review-edit"\n\t\t\t\t\t\t\t\t\t\t\t@click="instalmentRefund(item)"\n\t\t\t\t\t\t\t\t\t\t\t:disabled="disableInstalmentRefund(item)">\n\t\t\t\t\t\t\t\t\t\t\t{{ $tc(\'novalnet-payment.settingForm.extension.refundButton\') }}\n\t\t\t\t\t\t\t\t\t\t</sw-context-menu-item>\n\t\t\t\t\t\t\t\t\t{% endblock %}\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t{% endblock %}\n\n\t\t\t\t\t\t</sw-data-grid>\n\t\t\t\t\t</template>\n            </sw-card>\n\t\t</template>\n\t\t\n\t{% endblock %}\n{% endblock %}\n',inject:["NovalPaymentApiCredentialsService","repositoryFactory","acl"],mixins:["notification"],props:{orderId:{type:String,required:!0},paymentDetails:{type:Object,required:!0}},data:function(){return{status:0,displayAmount:0,displayPaidAmount:0,refundedAmount:0,orderAmount:0,InstalmentInfo:[],item:{},novalnetComments:"",isNovalnetPayment:!1,refundModalVisible:!1,confirmModalVisible:!1,zeroAmountVisible:!1,cancelModalVisible:!1,canInstalmentAllCancel:!1,canInstalmentRemainCancel:!1,instalmentRefundModalVisible:!1,instalmentRefundAmount:0,paymentMethod:"",payLater:["INVOICE","CASHPAYMENT","MULTIBANCO","PREPAYMENT"],instalmentPayments:["INSTALMENT_INVOICE","INSTALMENT_DIRECT_DEBIT_SEPA"],onholdStatus:["91","99","98","85"]}},computed:{getInstalmentColums:function(){return[{property:"number",dataIndex:"number",label:this.$tc("novalnet-payment.settingForm.instalmentNumber"),width:"50px"},{property:"reference",dataIndex:"reference",label:this.$tc("novalnet-payment.settingForm.instalmentReference"),width:"120px"},{property:"amount",dataIndex:"amount",label:this.$tc("novalnet-payment.settingForm.instalmentAmount"),width:"80px"},{property:"totalAmount",dataIndex:"totalAmount",visible:!1},{property:"refundAmount",dataIndex:"refundAmount",visible:!1},{property:"nextCycle",dataIndex:"nextCycle",label:this.$tc("novalnet-payment.settingForm.instalmentDate"),width:"120px"},{property:"status",dataIndex:"status",label:this.$tc("novalnet-payment.settingForm.instalmentStatus"),width:"80px"}]}},watch:{orderId:{deep:!0,handler:function(){var t=this;if(this.orderId){var e=this.repositoryFactory.create("order"),n=new S(1,1);n.addAssociation("transactions"),n.addAssociation("currency"),n.addFilter(S.equals("id",this.orderId)),e.search(n,k.api).then((function(e){var n=e.first();if(n){t.identifier||(t.identifier=n.orderNumber);var a=!1,o="",i=t.$tc("novalnet-payment.module.comments");n.transactions.sort((function(t,e){return new Date(e.createdAt)-new Date(t.createdAt)})).forEach((function(e){if(e.customFields&&e.customFields.novalnet_comments)return t.stateMachineState=e.stateMachineState.name,a=!0,""!=o&&(o+="<dt>"+i+"</dt>"),o+=e.customFields.novalnet_comments.split("/ ").join("<br />"),!0})),a?(t.novalnetComments=o.split("&&").join("<dt><strong>"+i+"</strong></dt>"),t.setNovalnetPayment(!0)):t.setNovalnetPayment(!1),null!=t.order.transactions.last().paymentMethod.customFields&&null!=t.order.transactions.last().paymentMethod.customFields.novalnet_payment_method_name&&"novalnetpay"==t.order.transactions.last().paymentMethod.customFields.novalnet_payment_method_name?t.NovalPaymentApiCredentialsService.getNovalnetPaymentMethod(t.order.orderNumber).then((function(e){null!=e&&null!=e&&null!=e.paymentName&&null!=e.paymentName?t.paymentMethod=e.paymentName:t.paymentMethod=t.order.transactions.last().paymentMethod.translated.distinguishableName})).catch((function(e){t.createNotificationError({message:"".concat(e.title,": ").concat(e.message)})})):t.paymentMethod=t.order.transactions.last().paymentMethod.translated.distinguishableName,t.canCaptureVoid=!1,t.canRefund=!1,t.canZeroAmountBooking=!1,t.canInstalmentCancel=!1,t.canInstalmentShow=!1,t.InstalmentInfo=[],t.canInstalmentAllCancel=!1,t.canInstalmentRemainCancel=!1,t.NovalPaymentApiCredentialsService.getNovalnetAmount(n.orderNumber).then((function(e){if(""!=e.data&&null!=e.data&&e.data.gatewayStatus){var a=JSON.parse(e.data.additionalDetails);if(t.refundableAmount=Number(e.data.amount)-Number(e.data.refundedAmount),t.orderAmount=Math.round(100*Number(n.price.totalPrice)),"ON_HOLD"==e.data.gatewayStatus||t.onholdStatus.includes(e.data.gatewayStatus)?t.canCaptureVoid=!0:(e.data.amount>0&&"CONFIRMED"==e.data.gatewayStatus&&!t.instalmentPayments.includes(e.data.paymentType)&&Number(e.data.refundedAmount)<Number(e.data.amount)||"PENDING"==e.data.gatewayStatus&&t.payLater.includes(e.data.paymentType))&&"MULTIBANCO"!=e.data.paymentType?t.canRefund=!0:t.instalmentPayments.includes(e.data.paymentType)&&"CONFIRMED"==e.data.gatewayStatus&&!a.cancelType?t.canInstalmentCancel=!0:"CREDITCARD"!=e.data.paymentType&&"DIRECT_DEBIT_SEPA"!=e.data.paymentType&&"GOOGLEPAY"!=e.data.paymentType&&"DIRECT_DEBIT_ACH"!=e.data.paymentType||0!=Number(e.data.amount)||0==t.orderAmount||(t.canZeroAmountBooking=!0),0!=e.data.amount?t.displayAmount=A(e.data.amount/100,n.currency.shortName):t.displayAmount=A(n.price.totalPrice,n.currency.shortName),0!=e.data.paidAmount?t.displayPaidAmount=A(e.data.paidAmount/100,n.currency.shortName):t.displayPaidAmount=A(0,n.currency.shortName),0!=e.data.refundedAmount?t.refundedAmount=A(e.data.refundedAmount/100,n.currency.shortName):t.refundedAmount=A(0,n.currency.shortName),t.instalmentPayments.includes(e.data.paymentType)&&"CONFIRMED"==e.data.gatewayStatus&&""!=a.InstalmentDetails){t.canInstalmentShow=!0,t.instalmentRefundAmount=e.data.refundedAmount;var o=1;Object.values(a.InstalmentDetails).forEach((function(e){t.InstalmentInfo.push({amount:A(e.amount/100,n.currency.shortName),totalAmount:e.amount,nextCycle:e.cycleDate,reference:e.reference,status:e.status,refundAmount:e.refundAmount,number:o}),o++})),0!=e.data.refundedAmount&&(t.canInstalmentCancel=!1,t.canInstalmentAllCancel=!1),null!=t.InstalmentInfo&&null!=t.InstalmentInfo&&t.InstalmentInfo.forEach((function(e){""!=e.reference&&null!=e.reference||(t.canInstalmentRemainCancel=!0)})),null!=a.cancelType&&""!=a.cancelType&&(t.canInstalmentRemainCancel=!1),0==t.canInstalmentRemainCancel&&0==e.data.refundedAmount?(t.canInstalmentCancel=!1,t.canInstalmentAllCancel=!0):1==t.canInstalmentCancel&&(t.canInstalmentRemainCancel=!1)}}})).catch((function(e){t.createNotificationError({message:"".concat(e.title,": ").concat(e.message)})}))}})).finally((function(){t.setNovalnetPayment(!1)}))}else this.setNovalnetPayment(!1)},immediate:!0}},methods:{setNovalnetPayment:function(t){t&&(this.isNovalnetPayment=t)},showConfirmModal:function(){this.status=100,this.confirmModalVisible=!0},showRefundModal:function(){this.refundModalVisible=!0},closeModals:function(){this.refundModalVisible=!1,this.confirmModalVisible=!1,this.cancelModalVisible=!1,this.zeroAmountVisible=!1,this.instalmentRefundModalVisible=!1},showInstalmentAllCancelModal:function(){this.instalmentRefundModalVisible=!0,this.cancelType="CANCEL_ALL_CYCLES"},showInstalmentRemainCancelModal:function(){this.instalmentRefundModalVisible=!0,this.cancelType="CANCEL_REMAINING_CYCLES"},showCancelModal:function(){this.status=103,this.cancelModalVisible=!0},showZeroAmountBlock:function(){this.zeroAmountVisible=!0},reloadPaymentDetails:function(){var t=this;this.closeModals(),this.$nextTick().then((function(){t.$emit("reload-payment")}))},instalmentRefund:function(t){this.refundableAmount=t.totalAmount-t.refundAmount,this.item=t,this.refundModalVisible=!0},showInstalmentCancelModal:function(){var t=this;null!=this.InstalmentInfo&&null!=this.InstalmentInfo&&this.InstalmentInfo.forEach((function(e){""!=e.reference&&null!=e.reference||(t.canInstalmentRemainCancel=!0)})),0==this.instalmentRefundAmount&&(this.canInstalmentAllCancel=!0),this.canInstalmentCancel=!1},disableInstalmentRefund:function(t){return null==t.reference||""==t.reference||t.refundAmount>=t.totalAmount||!this.acl.can("novalnet_extension.editor")}}});var I=Shopware,P=I.Component,x=I.State,M=I.Mixin,F=(I.Filter,I.Context),T=(I.ContextSwitchParameters,Shopware.Data.Criteria);Shopware.Utils.format.currency;P.override("sw-order-create-details",{template:'{% block sw_order_create_details_payment %}\n\n\t{% parent %}\n\t{% block sw_order_create_details_payment_novalnet_seaction %}\n\t\t<template v-if="novalnetPayment" >\n\t\t\t<sw-card\n\t\t\t\trows="2"  :isLoading="isLoading"\n\t\t\t\t:title="$tc(\'novalnet-payment.module.title\')" >\n\t\t\t\t<div >\n\t\t\t\t\t<iframe \n\t\t\t\t\t\tv-if="loaded"\n\t\t\t\t\t\tid ="adminnovalnetPaymentiframe"\n\t\t\t\t\t\twidth="100%"\n\t\t\t\t\t\tframeborder="0"\n\t\t\t\t\t  :src="iframe.src"></iframe>\n\t\t\t\t</div>\n\t\t\t\n\t\t\t</sw-card>\t\n\t\t\n\t\t</template>\n\t\t\n\t{% endblock %}\n{% endblock %}\n',inject:["NovalPaymentApiCredentialsService","repositoryFactory","acl"],mixins:[M.getByName("notification")],data:function(){return{isLoading:!1,loaded:!1,shouldDisable:!0,iframe:{src:""},paymentformurl:"",novalnetPayment:!1}},computed:{customer:function(){return x.get("swOrder").customer},cart:function(){return x.get("swOrder").cart},currency:function(){return x.get("swOrder").context.currency},cartPrice:function(){return this.cart.price},salesChannelContext:function(){return x.get("swOrder").context}},watch:{salesChannelContext:{deep:!0,handler:function(){var t=this;if(this.customer&&this.isCartTokenAvailable){this.isLoading=!0;var e=this.repositoryFactory.create("payment_method"),n=new T(1,1);n.addFilter(T.equals("id",this.salesChannelContext.paymentMethod.id)),e.search(n,F.api).then((function(e){var n=e.first();if(n&&(t.novalnetPayment=!1,null!=n.customFields&&"novalnetpay"==n.customFields.novalnet_payment_method_name)){if(null==t.currency)return void t.createNotificationError({title:t.$tc("novalnet-payment.settingForm.titleError"),message:t.$tc("novalnet-payment.settingForm.currencyFailureMessage")});if(null!=t.cartPrice&&(0==t.cartPrice.totalPrice||null==t.cartPrice.totalPrice))return void t.createNotificationError({title:t.$tc("novalnet-payment.settingForm.titleError"),message:t.$tc("novalnet-payment.settingForm.lineitemFailureMessage")});t.novalnetPayment=!0;var a="",o="",i="",l="";""==t.context.billingAddressId&&null===t.salesChannelContext.customer.defaultBillingAddress||(""!=t.context.billingAddressId&&t.customer.addresses.forEach((function(e){e.id==t.context.billingAddressId&&(i=e)})),a=""!=i?i:t.salesChannelContext.customer.defaultBillingAddress),""==t.context.shippingAddressId&&null===t.salesChannelContext.customer.defaultShippingAddress||(""!=t.context.shippingAddressId&&t.customer.addresses.forEach((function(e){e.id==t.context.shippingAddressId&&(l=e)})),o=""!=l?l:t.salesChannelContext.customer.defaultShippingAddress);var r=t.NovalPaymentApiCredentialsService,s=t.customer;t.NovalPaymentApiCredentialsService.novalnetPayment(o,a,t.cartPrice.totalPrice,t.currency.isoCode,t.customer).then((function(e){if(""!=e&&null!=e&&"SUCCESS"==e.result.status&&""!=e.result.redirect_url&&null!=e.result.redirect_url){t.iframe.src=e.result.redirect_url,t.loaded=!0;var n=document.createElement("script");n.setAttribute("src","https://cdn.novalnet.de/js/pv13/checkout.js?"+(new Date).getTime()),n.type="text/javascript",document.head.appendChild(n),t.paymentformurl=n,t.paymentformurl.addEventListener("load",(function(){document.querySelector(".sw-button-process").disabled=!1,t.onWindowLoad(r,s)}))}})).catch((function(e){t.createNotificationError({message:"".concat(e.title,": ").concat(e.message)})}))}}))}}},customer:{deep:!0,handler:function(){this.customer},immediate:!0}},methods:{onWindowLoad:function(t,e){var n=new NovalnetPaymentForm,a=document.querySelector(".sw-button-process"),o={iframe:"#adminnovalnetPaymentiframe",initForm:{uncheckPayments:!1,showButton:!1}};n.initiate(o),n.validationResponse((function(t){n.initiate(o)})),n.selectedPayment((function(t){t.payment_details.type})),a.addEventListener("click",(function(a){a.preventDefault(),a.stopImmediatePropagation(),n.getPayment((function(n){var a=JSON.stringify(n);t.paymentValue(a,e).then((function(t){}))}))}))}}});var E=Shopware,R=E.Component,$=E.State,B=E.Mixin;E.Filter,E.Context,Shopware.Data.Criteria,Shopware.Utils.format.currency;R.override("sw-order-create-base",{template:'{% block sw_order_create_details %}\n\t{% parent %}\n\t<template v-if="!isLoading" :isLoading="isLoading">\n\t\n\t\t <sw-order-create-details-payment\n\t\t\t:customer="customer"\n\t\t\t:cart-price="cartPrice"\n\t\t\t:currency="currency"\n\t\t/>\n\n    </template>\n\n{% endblock %}\n',inject:["NovalPaymentApiCredentialsService","repositoryFactory","acl"],mixins:[B.getByName("notification")],data:function(){return{isLoading:!1}},computed:{customer:function(){return $.get("swOrder").customer},cart:function(){return $.get("swOrder").cart},cartPrice:function(){return this.cart.price},currency:function(){return $.get("swOrder").context.currency},displayRounded:function(){return!!this.cartPrice&&this.cartPrice.rawTotal!==this.cartPrice.totalPrice},orderTotal:function(){return this.cartPrice?this.displayRounded?this.cartPrice.rawTotal:this.cartPrice.totalPrice:0}}});n("ajqF");var D=Shopware,L=D.Component,O=D.Mixin;Shopware.Utils.format.currency;L.register("novalnet-payment-refund-modal",{template:'{% block novalnet_payment_order_refund_modal %}\n    <sw-modal :title="$tc(\'novalnet-payment.settingForm.extension.refundButton\')"\n              @modal-close="closeModal">\n\t\t\n\t\t\t{% block novalnet_payment_order_refund_modal_content %}\n\t\t\t\t<template #default>\n\n\t\t\t\t\t{% block novalnet_payment_order_refund_modal_content_info_text %}\n\t\t\t\t\t\t<sw-container columns="1fr"\n\t\t\t\t\t\t\t\t\tgap="0px 30px">\n\t\t\t\t\t\t\t<sw-number-field v-model="refundableAmount"\n\t\t\t\t\t\t\t\t\t\t:max="item.amount"\n\t\t\t\t\t\t\t\t\t\t:min="0"\n\t\t\t\t\t\t\t\t\t\t:allowEmpty="false"\n\t\t\t\t\t\t\t\t\t\tnumberType="int"\n\t\t\t\t\t\t\t\t\t\t:label="$tc(\'novalnet-payment.settingForm.extension.amountTitle\')"\n\t\t\t\t\t\t\t\t\t\t:helpText="$tc(\'novalnet-payment.settingForm.extension.refundDescription\')">\n\t\t\t\t\t\t\t</sw-number-field>\n\t\t\t\t\t\t\t<sw-text-field v-model="reason"\n\t\t\t\t\t\t\t\t\t:placeholder="$tc(\'novalnet-payment.settingForm.extension.refundReference\')"\n\t\t\t\t\t\t\t\t\t:label="$tc(\'novalnet-payment.settingForm.extension.refundReference\')">\n\t\t\t\t\t\t\t</sw-text-field>\n\t\t\t\t\t\t</sw-container>\n\t\t\t\t\t{% endblock %}\n\t\t\t\t</template>\n\t\t\t{% endblock %}\n\n\t\t\t{% block novalnet_payment_order_refund_modal_actions %}\n\t\t\t\t<template #modal-footer>\n\n\t\t\t\t\t{% block novalnet_payment_order_refund_modal_confirm %}\n\t\t\t\t\t\t<sw-button secondary slim variant="primary" :disabled="disable" :square="false" :block="false" :isLoading="false" @click="novalnetRefund">\n\t\t\t\t\t\t\t{{ $tc(\'novalnet-payment.settingForm.extension.refundButton\') }}\n\t\t\t\t\t\t</sw-button>\n\t\t\t\t\t{% endblock %}\n\t\t\t\t</template>\n\t\t\t{% endblock %}\n    </sw-modal>\n{% endblock %}\n',props:{refundableAmount:{type:Number,required:!0},order:{type:Object,required:!0},item:{type:Object,required:!0}},inject:["NovalPaymentApiCredentialsService","repositoryFactory"],mixins:[O.getByName("notification"),O.getByName("sw-inline-snippet")],data:function(){return{reason:"",disable:!1}},methods:{closeModal:function(){this.$emit("modal-close")},novalnetRefund:function(){var t=this,e=this.refundableAmount,n=this.reason,a=this.order.orderNumber;"0"!=e?(this.disable=!0,this.NovalPaymentApiCredentialsService.refundPayment(a,e,n,this.item.reference).then((function(e){null!=e.result&&null!=e.result&&""!=e.result?null!=e.result.status&&null!=e.result.status&&""!=e.result.status&&"SUCCESS"==e.result.status?t.createNotificationSuccess({message:t.$tc("novalnet-payment.settingForm.extension.refundSuccess")}):null!=e.result.status_text&&null!=e.result.status_text&&""!=e.result.status_text?t.createNotificationError({message:e.result.status_text}):t.createNotificationError({message:t.$tc("novalnet-payment.settingForm.failureMessage")}):t.createNotificationError({message:t.$tc("novalnet-payment.settingForm.failureMessage")}),t.$emit("modal-close"),setTimeout(t.$router.go,3e3)})).catch((function(e){t.createNotificationError({message:"".concat(e.title,": ").concat(e.message),autoClose:!1}),t.$emit("modal-close")}))):this.createNotificationError({message:this.$tc("novalnet-payment.settingForm.amountRefundError")})}}});var j=Shopware,V=j.Component,z=j.Mixin;Shopware.Utils.format.currency;V.register("novalnet-payment-manage-transaction-modal",{template:'{% block novalnet_payment_order_manage_modal %}\n    <sw-modal :title="$tc(\'novalnet-payment.settingForm.extension.Managetitle\')"\n              @modal-close="closeModal">\n\n        {% block novalnet_payment_order_manage_modal_content %}\n            <template #default>\n\n                {% block novalnet_payment_order_manage_modal_content_info_text %}\n                    <sw-container columns="1fr" gap="0px 30px">\n\t\t\t\t\t\t<div v-if="status == 100">\n\t\t\t\t\t\t\t{{ $tc(\'novalnet-payment.settingForm.extension.confirmMessage\') }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div v-if="status == 103">\n\t\t\t\t\t\t\t{{ $tc(\'novalnet-payment.settingForm.extension.cancelMessage\') }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</sw-container>\n                {% endblock %}\n            </template>\n        {% endblock %}\n\n        {% block novalnet_payment_order_manage_modal_actions %}\n            <template #modal-footer>\n\n                {% block novalnet_payment_order_manage_modal_confirm %}\n                    <sw-button secondary slim variant="primary" :disabled="disable" :square="false" :block="false" :isLoading="false" @click="novalnetOnhold">\n\t\t\t\t\t\t{{ $tc(\'novalnet-payment.settingForm.extension.confirmLabel\') }}\n\t\t\t\t\t</sw-button>\n                {% endblock %}\n            </template>\n        {% endblock %}\n    </sw-modal>\n{% endblock %}\n',props:{status:{type:Number,required:!0},order:{type:Object,required:!0}},inject:["NovalPaymentApiCredentialsService","repositoryFactory"],mixins:[z.getByName("notification"),z.getByName("sw-inline-snippet")],data:function(){return{confirm:!0,cancel:!1,disable:!1}},methods:{closeModal:function(){this.$emit("modal-close")},novalnetOnhold:function(){var t=this,e=this.status,n=this.order.orderNumber;""!=e&&null!=e?(this.disable=!0,this.NovalPaymentApiCredentialsService.managePayment(n,e).then((function(e){""!=e?"SUCCESS"==e.result.status?"transaction_capture"==e.manageEvent?t.createNotificationSuccess({message:t.$tc("novalnet-payment.settingForm.extension.onholdSuccess")}):"transaction_cancel"==e.manageEvent&&t.createNotificationSuccess({message:t.$tc("novalnet-payment.settingForm.extension.onholdCancel")}):null!=e.result.status_text&&null!=e.result.status_text&&""!=e.result.status_text?t.createNotificationError({message:e.result.status_text}):t.createNotificationError({message:t.$tc("novalnet-payment.settingForm.failureMessage")}):t.createNotificationError({message:t.$tc("novalnet-payment.settingForm.failureMessage")}),t.$emit("modal-close"),setTimeout(t.$router.go,3e3)})).catch((function(e){t.createNotificationError({message:"".concat(e.title,": ").concat(e.message),autoClose:!1}),t.$emit("modal-close")}))):this.createNotificationError({message:this.$tc("novalnet-payment.settingForm.extension.onholdLabel")})}}});var U=Shopware,K=U.Component,q=U.Mixin;Shopware.Utils.format.currency;K.register("novalnet-payment-instalment-cancel-modal",{template:'{% block novalnet_payment_order_cancel_modal %}\n    <sw-modal :title="$tc(\'novalnet-payment.settingForm.extension.instalmentCancelLabel\')"\n              @modal-close="closeModal">\n\n\t\t\t{% block novalnet_payment_order_cancel_modal_content %}\n\t\t\t\t<template #default>\n\n\t\t\t\t\t{% block novalnet_payment_order_cancel_modal_content_info_text %}\n                        <sw-container columns="1fr" gap="0px 30px">\n                            <div v-if="cancelType == \'CANCEL_ALL_CYCLES\' ">\n\t\t\t\t\t\t\t\t{{ $tc(\'novalnet-payment.settingForm.extension.cancelAllCycleMessage\') }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div v-if="cancelType == \'CANCEL_REMAINING_CYCLES\' ">\n\t\t\t\t\t\t\t\t{{ $tc(\'novalnet-payment.settingForm.extension.cancelRemainingCycleMessage\') }}\n\t\t\t\t\t\t\t</div>\n                        </sw-container>\n\t\t\t\t\t{% endblock %}\n\t\t\t\t</template>\n\t\t\t{% endblock %}\n\n\t\t\t{% block novalnet_payment_order_cancel_modal_actions %}\n\t\t\t\t<template #modal-footer>\n\n\t\t\t\t\t{% block novalnet_payment_order_cancel_modal_confirm %}\n\t\t\t\t\t\t<sw-button secondary slim variant="primary" :disabled="disable" :square="false" :block="false" :isLoading="false" @click="novalnetInstalmentCancel">\n\t\t\t\t\t\t\t{{ $tc(\'novalnet-payment.settingForm.extension.confirmLabel\') }}\n\t\t\t\t\t\t</sw-button>\n\t\t\t\t\t{% endblock %}\n\t\t\t\t</template>\n\t\t\t{% endblock %}\n    </sw-modal>\n{% endblock %}\n',props:{cancelType:{type:String,required:!0},order:{type:Object,required:!0}},inject:["NovalPaymentApiCredentialsService","repositoryFactory"],mixins:[q.getByName("notification"),q.getByName("sw-inline-snippet")],data:function(){return{disable:!1}},methods:{closeModal:function(){this.$emit("modal-close")},novalnetInstalmentCancel:function(){var t=this,e=this.order.orderNumber,n=this.cancelType;this.disable=!0,this.NovalPaymentApiCredentialsService.instalmentCancel(e,n).then((function(e){""!=e.result?null!=e.result.status&&null!=e.result.status&&""!=e.result.status&&"SUCCESS"==e.result.status?t.createNotificationSuccess({message:t.$tc("novalnet-payment.settingForm.extension.instalmentSuccessMsg")}):null!=e.result.status_text&&null!=e.result.status_text&&""!=e.result.status_text?t.createNotificationError({message:e.result.status_text}):t.createNotificationError({message:t.$tc("novalnet-payment.settingForm.failureMessage")}):t.createNotificationError({message:t.$tc("novalnet-payment.settingForm.failureMessage")}),t.$emit("modal-close"),setTimeout(t.$router.go,3e3)})).catch((function(e){t.createNotificationError({message:"".concat(e.title,": ").concat(e.message),autoClose:!1}),t.$emit("modal-close")}))}}});var H=Shopware,W=H.Component,Z=H.Mixin;Shopware.Utils.format.currency;W.register("novalnet-payment-book-amount-modal",{template:'{% block novalnet_payment_order_refund_modal %}\n    <sw-modal :title="$tc(\'novalnet-payment.settingForm.extension.zeroAmountButton\')"\n              @modal-close="closeModal">\n\t\t\n\t\t\t{% block novalnet_payment_order_zero_amount_modal_content %}\n\t\t\t\t<template #default>\n\n\t\t\t\t\t{% block novalnet_payment_order_zero_amount_modal_content_info_text %}\n\t\t\t\t\t\t<sw-container columns="1fr"\n\t\t\t\t\t\t\t\t\tgap="0px 30px">\n\t\t\t\t\t\t\t<sw-number-field v-model="orderAmount"\n\t\t\t\t\t\t\t\t\t\t:min="0"\n\t\t\t\t\t\t\t\t\t\t:allowEmpty="false"\n\t\t\t\t\t\t\t\t\t\tnumberType="int"\n\t\t\t\t\t\t\t\t\t\t:label="$tc(\'novalnet-payment.settingForm.extension.zeroAmountTitle\')"\n\t\t\t\t\t\t\t\t\t\t:helpText="$tc(\'novalnet-payment.settingForm.extension.zeroAmountDescription\')">\n\t\t\t\t\t\t\t</sw-number-field>\n\t\t\t\t\t\t</sw-container>\n\t\t\t\t\t{% endblock %}\n\t\t\t\t</template>\n\t\t\t{% endblock %}\n\n\t\t\t{% block novalnet_payment_order_zero_amount_modal_actions %}\n\t\t\t\t<template #modal-footer>\n\n\t\t\t\t\t{% block novalnet_payment_order_zero_amount_modal_confirm %}\n\t\t\t\t\t\t<sw-button secondary slim variant="primary" :disabled="disable" :square="false" :block="false" :isLoading="false" @click="novalnetBookAmount">\n\t\t\t\t\t\t\t{{ $tc(\'novalnet-payment.settingForm.extension.bookButton\') }}\n\t\t\t\t\t\t</sw-button>\n\t\t\t\t\t{% endblock %}\n\t\t\t\t</template>\n\t\t\t{% endblock %}\n    </sw-modal>\n{% endblock %}\n',props:{orderAmount:{type:Number,required:!0},order:{type:Object,required:!0}},inject:["NovalPaymentApiCredentialsService","repositoryFactory"],mixins:[Z.getByName("notification"),Z.getByName("sw-inline-snippet")],data:function(){return{reason:"",disable:!1}},methods:{closeModal:function(){this.$emit("modal-close")},novalnetBookAmount:function(){var t=this,e=this.orderAmount,n=this.order.orderNumber;0!=e?(this.disable=!0,this.NovalPaymentApiCredentialsService.BookOrderAmount(n,e).then((function(e){null!=e.result&&null!=e.result&&""!=e.result?null!=e.result.status&&null!=e.result.status&&""!=e.result.status&&"SUCCESS"==e.result.status?t.createNotificationSuccess({message:t.$tc("novalnet-payment.settingForm.extension.bookedSuccess")}):null!=e.result.status_text&&null!=e.result.status_text&&""!=e.result.status_text?t.createNotificationError({message:e.result.status_text}):t.createNotificationError({message:t.$tc("novalnet-payment.settingForm.failureMessage")}):t.createNotificationError({message:t.$tc("novalnet-payment.settingForm.failureMessage")}),t.$emit("modal-close"),setTimeout(t.$router.go,3e3)})).catch((function(e){t.createNotificationError({message:"".concat(e.title,": ").concat(e.message),autoClose:!1}),t.$emit("modal-close")}))):this.createNotificationError({message:this.$tc("novalnet-payment.settingForm.amountError")})}}});var G=Shopware,Y=G.Component,J=G.Mixin;Shopware.Data.Criteria;Y.override("sw-order-user-card",{template:"{% block sw_order_detail_base_secondary_info_payment %}\n\t\t<template v-if=\"currentOrder.transactions.length > 0\">\n\t\t\t<dt>{{ $tc('sw-order.detailBase.labelPaymentMethod') }}</dt>\n\t\t\t<dd>\n\t\t\t\t{{ paymentMethod }} \n\t\t\t</dd>\n\t\t</template>\n{% endblock %}\n",inject:["NovalPaymentApiCredentialsService","repositoryFactory"],mixins:[J.getByName("notification")],props:{currentOrder:{type:Object,required:!0},isLoading:{type:Boolean,required:!0}},data:function(){return{paymentMethod:""}},watch:{currentOrder:{deep:!0,handler:function(){var t=this;""!=this.currentOrder&&(null!=this.currentOrder.transactions.last().paymentMethod.customFields&&null!=this.currentOrder.transactions.last().paymentMethod.customFields.novalnet_payment_method_name&&"novalnetpay"==this.currentOrder.transactions.last().paymentMethod.customFields.novalnet_payment_method_name?this.NovalPaymentApiCredentialsService.getNovalnetPaymentMethod(this.currentOrder.orderNumber).then((function(e){null!=e&&null!=e&&null!=e.paymentName&&null!=e.paymentName?t.paymentMethod=e.paymentName:t.paymentMethod=t.currentOrder.transactions.last().paymentMethod.translated.distinguishableName})).catch((function(e){t.createNotificationError({message:"".concat(e.title,": ").concat(e.message)})})):this.paymentMethod=this.currentOrder.transactions.last().paymentMethod.translated.distinguishableName)},immediate:!0}}});var Q=Shopware,X=Q.Component,tt=Q.Mixin,et=(Q.Filter,Q.Context),nt=Shopware.Data.Criteria;Shopware.Utils.format.currency;X.register("sw-order-create-details-payment",{template:'{% block sw_order_create_detail_payment_info %}\n\t\n\t\t<template v-if="novalnetPayment" >\n\t\t\t<sw-card :title="$tc(\'novalnet-payment.module.title\')" rows="2"  :isLoading="isLoading"  >\n\t\t\t\t<div >\n\t\t\t\t\t<iframe \n\t\t\t\t\t\tv-if="loaded"\n\t\t\t\t\t\tid ="adminnovalnetPaymentiframe"\n\t\t\t\t\t\twidth="100%"\n\t\t\t\t\t\tframeborder="0"\n\t\t\t\t\t  :src="iframe.src"></iframe>\n\t\t\t\t</div>\n\t\t\t</sw-card>\t\n\t\t</template>\n\t\n{% endblock %}\n',inject:["NovalPaymentApiCredentialsService","repositoryFactory"],mixins:[tt.getByName("notification")],props:{customer:{type:Object},cartPrice:{type:Object},currency:{type:Object},isLoading:{type:Boolean,required:!0}},data:function(){return{isLoading:!1,loaded:!1,shouldDisable:!0,iframe:{src:""},paymentformurl:"",novalnetPayment:!1}},watch:{customer:{deep:!0,handler:function(){var t=this;if(null!=this.customer){var e=this.repositoryFactory.create("payment_method"),n=new nt(1,1);n.addFilter(nt.equals("id",this.customer.salesChannel.paymentMethodId)),e.search(n,et.api).then((function(e){var n=e.first();if(n&&null!=n.customFields&&"novalnetpay"==n.customFields.novalnet_payment_method_name){if(null==t.currency)return void t.createNotificationError({title:t.$tc("novalnet-payment.settingForm.titleError"),message:t.$tc("novalnet-payment.settingForm.currencyFailureMessage")});if(null!=t.cartPrice&&(0==t.cartPrice.totalPrice||null==t.cartPrice.totalPrice))return void t.createNotificationError({title:t.$tc("novalnet-payment.settingForm.titleError"),message:t.$tc("novalnet-payment.settingForm.lineitemFailureMessage")});t.novalnetPayment=!0;var a="",o="";null===t.customer.billingAddress&&null===t.customer.defaultBillingAddress||(a=t.customer.billingAddress?t.customer.billingAddress:t.customer.defaultBillingAddress),null===t.customer.shippingAddress&&null===t.customer.defaultShippingAddress||(o=t.customer.shippingAddress?t.customer.shippingAddress:t.customer.defaultShippingAddress);var i=t.NovalPaymentApiCredentialsService,l=t.customer;t.NovalPaymentApiCredentialsService.novalnetPayment(o,a,t.cartPrice.totalPrice,t.currency.isoCode,t.customer).then((function(e){if(""!=e&&null!=e&&"SUCCESS"==e.result.status&&""!=e.result.redirect_url&&null!=e.result.redirect_url){t.iframe.src=e.result.redirect_url,t.loaded=!0;var n=document.createElement("script");n.setAttribute("src","https://cdn.novalnet.de/js/pv13/checkout.js?"+(new Date).getTime()),n.type="text/javascript",document.head.appendChild(n),t.paymentformurl=n,t.paymentformurl.addEventListener("load",(function(){t.onWindowLoad(i,l)}))}})).catch((function(e){t.createNotificationError({message:"".concat(e.title,": ").concat(e.message)})}))}}))}},immediate:!0}},methods:{onWindowLoad:function(t,e){var n=new NovalnetPaymentForm,a=document.querySelector(".sw-button-process"),o={iframe:"#adminnovalnetPaymentiframe",initForm:{uncheckPayments:!0,showButton:!1}};n.initiate(o),n.validationResponse((function(t){n.initiate(o)})),n.selectedPayment((function(t){t.payment_details.type})),a.addEventListener("click",(function(a){a.preventDefault(),a.stopImmediatePropagation(),n.getPayment((function(n){var a=JSON.stringify(n);t.paymentValue(a,e).then((function(t){}))}))}))}}});var at=Shopware,ot=at.Component,it=at.Mixin;Shopware.Data.Criteria;ot.override("sw-order-general-info",{template:"{% block sw_order_detail_base_general_info_summary_sub_description %}\n\t<div class=\"sw-order-general-info__summary-sub-description\">\n\t\t{{ $tc('sw-order.generalTab.info.summary.on') }}\n\t\t{{ order.orderDateTime | date({\n\t\t\thour: '2-digit',\n\t\t\tminute: '2-digit',\n\t\t\tday: '2-digit',\n\t\t\tmonth: '2-digit',\n\t\t\tyear: 'numeric'\n\t\t}) }}\n\t\t{{ $tc('sw-order.generalTab.info.summary.with') }}\n\t\t{{ paymentMethod }} \n\t\t<template v-if=\"order.deliveries.last()\">\n\t\t\t{{ $tc('sw-order.generalTab.info.summary.and') }}\n\t\t\t{{ order.deliveries.last().shippingMethod.translated.name }}\n\t\t</template>\n\t</div>\n{% endblock %}\n",inject:["NovalPaymentApiCredentialsService","repositoryFactory"],mixins:[it.getByName("notification")],props:{order:{type:Object,required:!0}},data:function(){return{paymentMethod:""}},watch:{order:{deep:!0,handler:function(){var t=this;""!=this.order&&(null!=this.order.transactions.last().paymentMethod.customFields&&null!=this.order.transactions.last().paymentMethod.customFields.novalnet_payment_method_name&&"novalnetpay"==this.order.transactions.last().paymentMethod.customFields.novalnet_payment_method_name?this.NovalPaymentApiCredentialsService.getNovalnetPaymentMethod(this.order.orderNumber).then((function(e){null!=e&&null!=e&&null!=e.paymentName&&null!=e.paymentName?t.paymentMethod=e.paymentName:t.paymentMethod=t.order.transactions.last().paymentMethod.translated.distinguishableName})).catch((function(e){t.createNotificationError({message:"".concat(e.title,": ").concat(e.message)})})):this.paymentMethod=this.order.transactions.last().paymentMethod.translated.distinguishableName)},immediate:!0}}});var lt=n("wllZ"),rt=n("iwzE");function st(t){return(st="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ct(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function dt(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,(o=a.key,i=void 0,i=function(t,e){if("object"!==st(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var a=n.call(t,e||"default");if("object"!==st(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===st(i)?i:String(i)),a)}var o,i}function mt(t,e){return(mt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function ut(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,a=ft(t);if(e){var o=ft(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return pt(this,n)}}function pt(t,e){if(e&&("object"===st(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ft(t){return(ft=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Shopware.Module.register("novalnet-payment",{type:"plugin",name:"NovalnetPayment",title:"novalnet-payment.module.title",description:"novalnet-payment.module.description",snippets:{"de-DE":lt,"en-GB":rt},routes:{index:{component:"novalnet-payment-settings",path:"index",meta:{parentPath:"sw.settings.index",privilege:"novalnet_payment.viewer"}},detail:{component:"novalnet-payment-settings",path:"settings",redirect:{name:"novalnet.payment.credentials"},children:{credentials:{component:"novalnet-payment-credentials",path:"credentials",meta:{parentPath:"sw.settings.index",privilege:"novalnet_payment.viewer"}}}}},settingsItem:{group:"plugins",to:"novalnet.payment.detail.credentials",iconComponent:"novalnet-payment-settings-icon",backgroundEnabled:!0,privilege:"novalnet_payment.viewer"}});var ht=Shopware.Classes.ApiService,yt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&mt(t,e)}(i,t);var e,n,a,o=ut(i);function i(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"novalnet-payment";return ct(this,i),o.call(this,t,e,n)}return e=i,(n=[{key:"validateApiCredentials",value:function(t,e){return this.getBasicHeaders(),this.httpClient.post("_action/".concat(this.getApiBasePath(),"/validate-api-credentials"),{clientId:t,accessKey:e},{headers:this.getBasicHeaders()}).then((function(t){return ht.handleResponse(t)}))}},{key:"getNovalnetAmount",value:function(t){return this.getBasicHeaders(),this.httpClient.post("_action/".concat(this.getApiBasePath(),"/transaction-amount"),{orderNumber:t},{headers:this.getBasicHeaders()}).then((function(t){return ht.handleResponse(t)}))}},{key:"refundPayment",value:function(t,e,n,a){return this.getBasicHeaders(),this.httpClient.post("_action/".concat(this.getApiBasePath(),"/refund-amount"),{orderNumber:t,refundAmount:e,reason:n,instalmentCycleTid:a},{headers:this.getBasicHeaders()}).then((function(t){return ht.handleResponse(t)}))}},{key:"managePayment",value:function(t,e){return this.getBasicHeaders(),this.httpClient.post("_action/".concat(this.getApiBasePath(),"/manage-payment"),{orderNumber:t,status:e},{headers:this.getBasicHeaders()}).then((function(t){return ht.handleResponse(t)}))}},{key:"instalmentCancel",value:function(t,e){return this.getBasicHeaders(),this.httpClient.post("_action/".concat(this.getApiBasePath(),"/instalment-cancel"),{orderNumber:t,cancelType:e},{headers:this.getBasicHeaders()}).then((function(t){return ht.handleResponse(t)}))}},{key:"BookOrderAmount",value:function(t,e){var n="_action/".concat(this.getApiBasePath(),"/book-amount");return this.httpClient.post(n,{orderNumber:t,bookAmount:e},{headers:this.getBasicHeaders()}).then((function(t){return ht.handleResponse(t)}))}},{key:"getNovalnetPaymentMethod",value:function(t){var e="_action/".concat(this.getApiBasePath(),"/novalnet-paymentmethod");return this.httpClient.post(e,{orderNumber:t},{headers:this.getBasicHeaders()}).then((function(t){return ht.handleResponse(t)}))}},{key:"configureWebhookUrl",value:function(t,e,n){var a="_action/".concat(this.getApiBasePath(),"/webhook-url-configure");return this.httpClient.post(a,{url:t,productActivationKey:e,paymentAccessKey:n},{headers:this.getBasicHeaders()}).then((function(t){return ht.handleResponse(t)}))}},{key:"novalnetPayment",value:function(t,e,n,a,o){var i="_action/".concat(this.getApiBasePath(),"/novalnet-payment");return this.httpClient.post(i,{shippingaddress:t,billingaddress:e,amount:n,currency:a,customer:o},{headers:this.getBasicHeaders()}).then((function(t){return ht.handleResponse(t)}))}},{key:"paymentDetails",value:function(t){var e="_action/".concat(this.getApiBasePath(),"/novalnet-select-payment");return this.httpClient.post(e,{paymentSelected:t},{headers:this.getBasicHeaders()}).then((function(t){return ht.handleResponse(t)}))}},{key:"paymentValue",value:function(t,e){var n="_action/".concat(this.getApiBasePath(),"/payment-value-data");return this.httpClient.post(n,{value:t,customer:e},{headers:this.getBasicHeaders()}).then((function(t){return ht.handleResponse(t)}))}},{key:"getShopVersion",value:function(){var t="_action/".concat(this.getApiBasePath(),"/shop-version");return this.httpClient.post(t,{},{headers:this.getBasicHeaders()}).then((function(t){return ht.handleResponse(t)}))}}])&&dt(e.prototype,n),a&&dt(e,a),Object.defineProperty(e,"prototype",{writable:!1}),i}(ht),vt=Shopware.Application;vt.addServiceProvider("NovalPaymentApiCredentialsService",(function(t){var e=vt.getContainer("init");return new yt(e.httpClient,t.loginService)}));n("3Y7e")},ajqF:function(t,e){var n=Shopware,a=n.Component,o=n.State,i=n.Mixin,l=(n.Filter,n.Context),r=(n.ContextSwitchParameters,Shopware.Data.Criteria);Shopware.Utils.format.currency;a.override("sw-order-create-general",{inject:["NovalPaymentApiCredentialsService","repositoryFactory","acl"],mixins:[i.getByName("notification")],data:function(){return{isLoading:!1}},computed:{customer:function(){return o.get("swOrder").customer},cart:function(){return o.get("swOrder").cart},currency:function(){return o.get("swOrder").context.currency},cartPrice:function(){return this.cart.price},salesChannelContext:function(){return o.get("swOrder").context}},watch:{salesChannelContext:{deep:!0,handler:function(){var t=this;if(this.customer){this.isLoading=!0;var e=this.repositoryFactory.create("payment_method"),n=new r(1,1);n.addFilter(r.equals("id",this.salesChannelContext.paymentMethod.id)),e.search(n,l.api).then((function(e){var n=e.first();n&&(t.novalnetPayment=!1,null!=n.customFields&&"novalnetpay"==n.customFields.novalnet_payment_method_name&&t.onWindowLoad())}))}}},customer:{deep:!0,handler:function(){this.customer},immediate:!0}},methods:{onWindowLoad:function(){document.querySelector(".sw-button-process").disabled=!0}}})},iwzE:function(t){t.exports=JSON.parse('{"novalnet-payment":{"module":{"title":"Novalnet","description":"PCI compliant and seamless integration with various payment types and payment processing services in one unique platform...","projectInfo":"Your project is in test mode","comments":"Comments","generalInfo":"Please read the <a href=\'https://www.novalnet.com/docs/plugins/installation-guides/shopware-6-installation-guide.pdf\' target=\'_blank\' style=\'text-decoration: underline; font-weight: bold; color:#0080c9;\'> Installation Guide </a> before you start and login to the <a href=\'https://admin.novalnet.de\' target=\'_blank\' style=\'text-decoration: underline; font-weight: bold; color:#0080c9;\'> Novalnet Admin Portal </a> using your merchant account. To get a merchant account, mail to <a href=\'mailto:sales@novalnet.de\' style=\'text-decoration: underline; font-weight: bold; color:#0080c9;\'> sales@novalnet.de</a> or call +49 (089) 923068320","globalTitle":"Global Configuration","installationInfo":"For setup and handling of the Novalnet-Payment plugin you can find the installation guide <a href=\'https://www.novalnet.com/docs/plugins/installation-guides/shopware-6-installation-guide.pdf\' target=\'_blank\' style=\'text-decoration: underline; font-weight: bold; color:#0080c9;\'>Here</a>","PaymentConfiguration":"<span style=\'font-weight: bold; color:red;\'>Important notice:</span> Payment plugin configurations are now available in the <a href=\'https://admin.novalnet.de/\' target=\'_blank\' style=\'text-decoration: underline; font-weight: bold; color:#0080c9;\'> Novalnet Admin Portal</a>. Navigate to the <b> Projects > choose your project > Payment plugin configuration, </b> to configure them. <br><br> Novalnet allows you to verify the payment method behaviour before going into production mode by using test payment data. Access the Novalnet test payment data available <a href=\'https://developer.novalnet.de/testing\' target=\'_blank\' style=\'text-decoration: underline; font-weight: bold; color:#0080c9;\'> Here </a>"},"settingForm":{"title":"Novalnet","statusTitle":"Status","amountError":"Invalid amount","buttons":{"save":"Save"},"credentials":{"cardTitle":"Novalnet API Configuration","activationKey":{"label":"Product activation key *","tooltipText":"Your product activation key is a unique token for merchant authentication and payment processing. Get your Product activation key from the <a href=\'https://admin.novalnet.de\' target=\'_blank\' style=\'text-decoration: underline; font-weight: bold; color:#0080c9;\'> Novalnet Admin Portal </a>: Projects > Choose your project > API credentials > API Signature (Product activation key)"},"accessKey":{"label":"Payment access key *","tooltipText":"Your secret key used to encrypt the data to avoid user manipulation and fraud. Get your Payment access key from the <a href=\'https://admin.novalnet.de\' target=\'_blank\' style=\'text-decoration: underline; font-weight: bold; color:#0080c9;\'> Novalnet Admin Portal </a> Projects > Choose your project > API credentials > Payment access key"},"tariff":{"label":"Select Tariff ID *","tooltipText":"Select a Tariff ID to match the preferred tariff plan you created at the Novalnet Admin Portal for this project","emptyText":"Select Tariff ID"},"orderEmailMode":{"label":"Enable Order Confirmation E-mail","tooltipText":"Enable this configuration to send another Order Confirmation e-mail with Novalnet transaction details to the end customer for orders made through Invoice, Prepayment, Cashpayment, and Multibanco payments. (By default initial Order confirmation e-mail will send to end customers without Novalnet transaction details)"}},"merchantSettings":{"cardTitle":"Notification / Webhook URL Setup","deactivateIp":{"label":"Allow manual testing of the Notification / Webhook URL","tooltipText":"Enable this to test the Novalnet Notification / Webhook URL manually. Disable this before setting your shop live to block unauthorized calls from external parties"},"mailTo":{"label":"Send e-mail to","tooltipText":"Notification / Webhook URL execution messages will be sent to this e-mail"},"callbackUrl":{"label":"Notification / Webhook URL","button":"Configure","tooltipText":"You must configure the webhook endpoint in your <a href=\'https://admin.novalnet.de\' target=\'_blank\' style=\'text-decoration: underline; font-weight: bold; color:#0080c9;\'>Novalnet Admin portal</a>. This will allow you to receive notifications about the transaction."}},"extension":{"paidTooltip":"Total paid amount","refundTooltip":"Refuned amount","refundButton":"Refund","amountTitle":"Refund amount","zeroAmountTitle":"Order Booked for this amount","refundDescription":"Please enter the refund amount (in minimum unit of currency. E.g. enter 100 which is equal to 1.00)","refundReference":"Refund reference","confirmLabel":"Confirm","cancelLabel":"Cancel","Managetitle":"Manage Transaction","confirmMessage":"Are you sure you want to capture the payment?","cancelMessage":"Are you sure you want to cancel the payment?","cancelAllCycleMessage":"Are you sure you want to cancel all cycle installment?","cancelRemainingCycleMessage":"Are you sure you want to cancel remaining cycle installment?","refundSuccess":"Your refund was successful.","onholdSuccess":"The transaction has been confirmed.","onholdCancel":"The transaction has been canceled","instalmentCancelLabel":"Instalment Cancel","instalmentAllCancelLabel":"Cancel All Instalment","instalmentRemainCancelLabel":"Cancel All Remaining Instalment","instalmentSuccessMsg":"Instalment canceled successfully.","zeroAmountButton":"Book Amount","bookedSuccess":"Your amount booked was successful.","zeroAmountDescription":"Please enter the amount (in minimum unit of currency. E.g. enter 100 which is equal to 1.00)","bookButton":"Book"},"titleSuccess":"Success","successMessage":"Novalnet merchant details are configured successfully.","titleError":"Error","apiFailureMessage":"Please configure Novalnet Global Configuration","customerFailureMessage":"Please select your customer","currencyFailureMessage":"Please select currency","lineitemFailureMessage":"Please Add Product","amountRefundError":"Invalid refund amount","failureMessage":"Please fill in the required fields","instalmentNumber":"S.No","instalmentReference":"Novalnet Transaction ID","instalmentDate":"Next Instalment Date","instalmentAmount":"Amount","instalmentStatus":"Status","instalmentInfo":"Instalment Summary","webhookUrlFailure":"Please enter the valid Webhook URL","webhookUrlSuccess":"Notification / Webhook URL is configured successfully in Novalnet Admin Portal"}},"sw-privileges":{"permissions":{"novalnet_extension":{"label":"Novalnet Extensions"},"parents":{"novalnet_payment":"Novalnet"},"novalnet_payment":{"label":"Novalnet Settings"}}}}')},ixpb:function(t,e,n){},nZI3:function(t,e,n){var a=n("8zbr");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,n("ydqr").default)("61c70a1b",a,!0,{})},odc0:function(t,e,n){},oguu:function(t,e,n){var a=n("9Izg");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,n("ydqr").default)("6c46fed8",a,!0,{})},wllZ:function(t){t.exports=JSON.parse('{"novalnet-payment":{"module":{"title":"Novalnet","description":"PCI-konforme und lckenlose Integration mit verschiedenen Zahlungsarten und Zahlungsdienstleistungen auf einer Plattform.","projectInfo":"Ihr Projekt befindet sich im Testmodus","comments":"Kommentare","generalInfo":"Bevor Sie beginnen, lesen Sie bitte die <a href=\'https://www.novalnet.com/docs/plugins/installation-guides/shopware-6-installation-guide.pdf\' target=\'_blank\' style=\'text-decoration: underline; font-weight: bold; color:#0080c9;\'> Installationsanleitung </a> und melden Sie sich mit Ihrem Hndlerkonto im <a href=\'https://admin.novalnet.de\' target=\'_blank\' style=\'text-decoration: underline; font-weight: bold; color:#0080c9;\'> Novalnet Admin-Portal </a> an. Um ein Hndlerkonto zu erhalten, senden Sie bitte eine E-Mail an <a href=\'mailto:sales@novalnet.de\' style=\'text-decoration: underline; font-weight: bold; color:#0080c9;\'> sales@novalnet.de </a> oder rufen Sie uns unter +49 89 923068320 an","globalTitle":"Konfigurationseinstellungen","installationInfo":"Fr die Einrichtung und Verwendung des Plugins finden Sie die Installationsanleitung <a href=\'https://www.novalnet.com/docs/plugins/installation-guides/shopware-6-installation-guide.pdf\' target=\'_blank\' style=\'text-decoration: underline; font-weight: bold; color:#0080c9;\'>Here</a>","PaymentConfiguration":"<span style=\'font-weight: bold; color:red;\'>Wichtiger Hinweis:</span>Die Konfiguration der Zahlungsplugins sind jetzt im <a href=\'https://admin.novalnet.de/\' target=\'_blank\' style=\'text-decoration: underline; font-weight: bold; color:#0080c9;\'> Novalnet Admin Portal</a> verfgbar. Navigieren Sie zu <b> Projekts > Whlen Sie Ihr Projekt > Konfiguration des Zahlungsplugins, </b> um sie zu konfigurieren. <br><br> Novalnet ermglicht es Ihnen, das Verhalten der Zahlungsmethode zu berprfen, bevor Sie in den Produktionsmodus gehen, indem Sie Testzahlungsdaten verwenden. Zugang zu den Novalnet-Testzahlungsdaten finden Sie <a href=\'https://developer.novalnet.de/testing\' target=\'_blank\' style=\'text-decoration: underline; font-weight: bold; color:#0080c9;\'> Hier </a>"},"settingForm":{"title":"Novalnet","statusTitle":"Zustand","amountError":"Ungltiger Betrag","buttons":{"save":"Speichern"},"credentials":{"cardTitle":"Novalnet API-Konfiguration","activationKey":{"label":"Aktivierungsschlssel des Produkts *","tooltipText":"Ihr Produktaktivierungsschlssel ist ein eindeutiger Token fr die Hndlerauthentifizierung und Zahlungsabwicklung.Ihr Produktaktivierungsschlssel ist ein eindeutiges Token fr die Hndlerauthentifizierung und Zahlungsabwicklung. Ihren Produktaktivierungsschlssel finden Sie im <a href=\'https://admin.novalnet.de\' target=\'_blank\' style=\'text-decoration: underline; font-weight: bold; color:#0080c9;\'> Novalnet Admin-Portal </a>: Projekts > Whlen Sie Ihr Projekt > API-Anmeldeinformationen > API-Signatur (Produktaktivierungsschlssel)"},"accessKey":{"label":"Zahlungs-Zugriffsschlssel *","tooltipText":"Ihr geheimer Schlssel zur Verschlsselung der Daten, um Manipulation und Betrug zu vermeiden. Ihren Paymentzugriffsschlssel finden Sie im <a href=\'https://admin.novalnet.de\' target=\'_blank\' style=\'text-decoration: underline; font-weight: bold; color:#0080c9;\'> Novalnet Admin-Portal </a>: Projekts > Whlen Sie Ihr Projekt > API-Anmeldeinformationen > Paymentzugriffsschlssel"},"tariff":{"label":"Auswahl der Tarif-ID *","tooltipText":"Whlen Sie eine Tarif-ID, die dem bevorzugten Tarifplan entspricht, den Sie im Novalnet Admin-Portal fr dieses Projekt erstellt haben","emptyText":"Tarif-ID auswhlen"},"orderEmailMode":{"label":" Bestellbesttigung per E-Mail aktivieren","tooltipText":"Aktivieren Sie diesen Reiter, um eine weitere Bestellbesttigungs-E-Mail mit Novalnet-Transaktionsdetails an den Endkunden fr Bestellungen zu senden, die ber Rechnung, Vorkasse, Barzahlen oder Multibanco gettigt wurden. (Standardmig wird die erste Bestellbesttigungs-E-Mail an Endkunden ohne Novalnet-Transaktionsdetails gesendet.)"}},"merchantSettings":{"cardTitle":"Benachrichtigungs- / Webhook-URL festlegen","deactivateIp":{"label":"Manuelles Testen der Benachrichtigungs / Webhook-URL erlauben","tooltipText":"Aktivieren Sie diese Option, um die Novalnet-Benachrichtigungs-/Webhook-URL manuell zu testen. Deaktivieren Sie die Option, bevor Sie Ihren Shop liveschalten, um unautorisierte Zugriffe von Dritten zu blockieren."},"mailTo":{"label":"E-Mails senden an","tooltipText":"E-Mail-Benachrichtigungen werden an diese E-Mail-Adresse gesendet"},"callbackUrl":{"label":"Benachrichtigungs- / Webhook-URL","button":"Konfigurieren","tooltipText":"Sie mssen die folgende Webhook-URL im <a href=\'https://admin.novalnet.de\' target=\'_blank\' style=\'text-decoration: underline; font-weight: bold; color:#0080c9;\'>Novalnet Admin-Portal</a> hinzufgen. Dadurch knnen Sie Benachrichtigungen ber den Transaktionsstatus erhalten."}},"extension":{"paidTooltip":"Gezahlter Gesamtbetrag","refundTooltip":"Rckerstatteter Betrag","refundButton":"Rckerstattung","amountTitle":"Rckerstattungsbetrag","refundDescription":"Geben Sie bitte den erstatteten Betrag ein (in der kleinsten Whrungseinheit, z.B. 100 Cent = entsprechen 1.00 EUR)","refundReference":"Referenz fr die Rckerstattung","confirmLabel":"Besttigen","cancelLabel":"Stornieren","cancelAllCycleMessage":"Sind Sie sicher, dass Sie alle Ratenzahlungen stornieren wollen?","cancelRemainingCycleMessage":"Sind Sie sicher, dass Sie die verbleibende Zyklusrate stornieren mchten?","Managetitle":"Transaktion verwalten","confirmMessage":"Sind Sie sicher, dass Sie die Zahlung einziehen mchten?","cancelMessage":"Sind Sie sicher, dass Sie die Zahlung stornieren wollen?","refundSuccess":"Die Rckerstattung war erfolgreich.","onholdSuccess":"Die Transaktion wurde besttigt","onholdCancel":"Die Transaktion wurde storniert","instalmentCancelLabel":"Ratenzahlung Stornieren","instalmentAllCancelLabel":"Gesamte Ratenzahlung stornieren","instalmentRemainCancelLabel":"Alle brigen Installationen abbrechen","instalmentSuccessMsg":"Die Ratenzahlung wurde erfolgreich abgebrochen.","zeroAmountButton":"Buchbetrag","bookedSuccess":"Ihr gebuchter Betrag war erfolgreich.","zeroAmountTitle":"Gebuchter Auftrag fr diesen Betrag","zeroAmountDescription":"Bitte geben Sie den Betrag ein (in der kleinsten Whrungseinheit, z.B. 100, was 1,00 entspricht)","bookButton":"Buchen Sie"},"titleSuccess":"Success","successMessage":"Die Novalnet-Hndlerdaten wurden erfolgreich eingestellt.","titleError":"Error","apiFailureMessage":"Konfigurieren Sie bitte die zentralen Novalnet-Einstellungen","customerFailureMessage":"Bitte whlen Sie Ihren Kunden","currencyFailureMessage":"Bitte whlen Sie eine Whrung","lineitemFailureMessage":"Bitte Produkt hinzufgen","amountRefundError":"Ungltiger Rckerstattungsbetrag","failureMessage":"Bitte fllen Sie die erforderlichen Felder aus","instalmentNumber":"S.No","instalmentReference":"Novalnet-Transaktions-ID","instalmentDate":"Nchste Rate fllig am","instalmentAmount":"Betrag","instalmentStatus":"Status","instalmentInfo":"Zusammenfassung der Ratenzahlung","webhookUrlFailure":"Bitte geben Sie eine gltige Webhook-URL ein","webhookUrlSuccess":"Callbackskript-/ Webhook-URL wurde erfolgreich im Novalnet Admin Portal konfiguriert"}},"sw-privileges":{"permissions":{"novalnet_extension":{"label":"Novalnet-Erweiterungen"},"parents":{"novalnet_payment":"Novalnet"},"novalnet_payment":{"label":"Novalnet Einstellungen"}}}}')},ydqr:function(t,e,n){"use strict";function a(t,e){for(var n=[],a={},o=0;o<e.length;o++){var i=e[o],l=i[0],r={id:t+":"+o,css:i[1],media:i[2],sourceMap:i[3]};a[l]?a[l].parts.push(r):n.push(a[l]={id:l,parts:[r]})}return n}n.r(e),n.d(e,"default",(function(){return f}));var o="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!o)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var i={},l=o&&(document.head||document.getElementsByTagName("head")[0]),r=null,s=0,c=!1,d=function(){},m=null,u="data-vue-ssr-id",p="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function f(t,e,n,o){c=n,m=o||{};var l=a(t,e);return h(l),function(e){for(var n=[],o=0;o<l.length;o++){var r=l[o];(s=i[r.id]).refs--,n.push(s)}e?h(l=a(t,e)):l=[];for(o=0;o<n.length;o++){var s;if(0===(s=n[o]).refs){for(var c=0;c<s.parts.length;c++)s.parts[c]();delete i[s.id]}}}}function h(t){for(var e=0;e<t.length;e++){var n=t[e],a=i[n.id];if(a){a.refs++;for(var o=0;o<a.parts.length;o++)a.parts[o](n.parts[o]);for(;o<n.parts.length;o++)a.parts.push(v(n.parts[o]));a.parts.length>n.parts.length&&(a.parts.length=n.parts.length)}else{var l=[];for(o=0;o<n.parts.length;o++)l.push(v(n.parts[o]));i[n.id]={id:n.id,refs:1,parts:l}}}}function y(){var t=document.createElement("style");return t.type="text/css",l.appendChild(t),t}function v(t){var e,n,a=document.querySelector("style["+u+'~="'+t.id+'"]');if(a){if(c)return d;a.parentNode.removeChild(a)}if(p){var o=s++;a=r||(r=y()),e=_.bind(null,a,o,!1),n=_.bind(null,a,o,!0)}else a=y(),e=w.bind(null,a),n=function(){a.parentNode.removeChild(a)};return e(t),function(a){if(a){if(a.css===t.css&&a.media===t.media&&a.sourceMap===t.sourceMap)return;e(t=a)}else n()}}var g,b=(g=[],function(t,e){return g[t]=e,g.filter(Boolean).join("\n")});function _(t,e,n,a){var o=n?"":a.css;if(t.styleSheet)t.styleSheet.cssText=b(e,o);else{var i=document.createTextNode(o),l=t.childNodes;l[e]&&t.removeChild(l[e]),l.length?t.insertBefore(i,l[e]):t.appendChild(i)}}function w(t,e){var n=e.css,a=e.media,o=e.sourceMap;if(a&&t.setAttribute("media",a),m.ssrId&&t.setAttribute(u,e.id),o&&(n+="\n/*# sourceURL="+o.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */"),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}}});